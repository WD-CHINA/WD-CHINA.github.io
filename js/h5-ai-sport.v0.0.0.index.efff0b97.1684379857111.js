var Z=(f,M,s)=>new Promise((k,S)=>{var h=e=>{try{n(s.next(e))}catch(l){S(l)}},p=e=>{try{n(s.throw(e))}catch(l){S(l)}},n=e=>e.done?k(e.value):Promise.resolve(e.value).then(h,p);n((s=s.apply(f,M)).next())});import{_ as de}from"./h5-ai-sport.v0.0.0.GameOverDialog.c9df0113.1684379857111.js";import{_ as fe,a as _e}from"./h5-ai-sport.v0.0.0.GameCounter.7a2beafd.1684379857111.js";import{s as pe,c as ge,_ as Se}from"./h5-ai-sport.v0.0.0.utils.de482c22.1684379857111.js";import{m as o,o as he,M as Ie,N as we,O as ye,d as Me,c as $,e as ke,j as ee,y as u,L as te,P as ae,Q as be,R as ne,S as oe,v as le,b as De,_ as Te}from"./h5-ai-sport.v0.0.0.index.a6c8dc0f.1684379857111.js";import{v as re,s as xe,a as se,b as Be}from"./h5-ai-sport.v0.0.0.bgAudio.47f05ebc.1684379857111.js";import{u as Re}from"./h5-ai-sport.v0.0.0.Setting.b13cabb0.1684379857111.js";import"./h5-ai-sport.v0.0.0.index.92382d81.1684379857111.js";let F=0,Q=0,q=0,z=1,H=-1,J=0,C=0,E=0,A=0,O=0,L=0;const Ce=(f,M)=>{const s=f[11].y,k=f[12].y,S=f[5].y,h=f[6].y,p=f[15].y,n=f[16].y,e=(S+h)/2,l=(p+n)/2,I=(s+k)/2,t=e-F;F==0&&(J=e);const c=l-Q;let r=-1;const w=Math.abs(c)/Math.abs(t);t<0?(C+=t*-1,c<0&&w>.1&&(E+=c*-1),A=0,O=0):t>0&&t<J?(A+=t,c>0&&w>.1&&(O+=c),C=0,E=0):(C=0,E=0,A=0,O=0);const v=Math.abs(I-e)/10;C>v&&E>0?(r=q,L=0):A>v&&O>0&&L<5?r=z:(r=-1,L++),H==q&&r==z&&(M.value+=1,M.value&&re("https://go-ran-pic.lovedabai.com/sound/Sport_Ball_appear.mp3")),r>-1&&(H=r),F=e,Q=l},Ee=()=>{F=0,Q=0,q=0,z=1,H=-1,J=0,C=0,E=0,A=0,O=0,L=0};function Ae(){const f=Re(),M=we(),s=60,k=["appear","tooClose","start","timeOut","comeOn","5","4","3","2","1","keepMoving","endsoon","adjustAngle"],S={};let h=[];const p=[1,2,3],n=o(!0),e=o(0),l=o(0),I=o(3),t=o(s),c=o(0),r=o(!1),w=o(!1),v=o(),T=o(),B=o(),i=o(),_=o(),m=o(),g=o(),b=o(10),R=o(0),P=o(0);he(()=>{k.forEach(a=>{const x=a==="appear"?"Sport_Ball_appear":a;S[a]=`https://go-ran-pic.lovedabai.com/sound/${x}.mp3`})}),Ie(()=>{G(),xe(),se()});const d=a=>{re(S[`${a}`])},U=(a,x,D)=>{h=pe(a),ge(a,x,D)&&(!r.value&&!v.value?(l.value=3,I.value=p.at(-1),ue()):l.value||(n.value=!1,Ce(a,e),K()))},ue=()=>{let a=3;n.value=!1,clearInterval(T.value),T.value=setInterval(()=>Z(this,null,function*(){a>0?(yield d(a),yield a--):(d("start"),clearInterval(T.value),f.bgMusic&&Be("https://yunketang-file.dream-sports.cn/sound/sport_background_music_03.mp3"))}),1e3),v.value=setInterval(()=>{l.value>0?(l.value--,I.value=p[l.value===2?1:0]):(clearInterval(v.value),v.value=void 0,l.value=0,r.value=!0,ce())},1e3)},ce=()=>{B.value=setInterval(()=>{t.value>0?(t.value===21&&d("comeOn"),t.value--,t.value==0?d("timeOut"):t.value<=5&&d(t.value)):(clearInterval(B.value),N())},1e3)},ie=()=>{g.value=setInterval(()=>{b.value>1?b.value-=1:(clearInterval(g.value),G())},1e3)},N=()=>{clearInterval(T.value),clearInterval(v.value),clearInterval(B.value),clearInterval(i.value),clearInterval(_.value),clearInterval(m.value),clearInterval(g.value),T.value=void 0,v.value=void 0,B.value=void 0,i.value=0,_.value=void 0,m.value=void 0,g.value=void 0};function G(){h=[],n.value=!0,e.value=0,t.value=s,l.value=0,I.value=3,c.value=0,r.value=!1,w.value=!1,b.value=10,Ee(),N(),se()}const ve=()=>{e.value>=1&&ye({code:M.name,score:e.value>0?e.value-1:0,time:s-t.value,photos:[]}).then(a=>{R.value=a.result.exceedRate?Number((a.result.exceedRate*100).toFixed(2)):0,P.value=a.result.integral})};function me(a){if(e.value===0)return!0;let x=0;const D=h.slice(-5);return D.length===5?(D.forEach((y,j)=>{if(j!==0){let W=!1;a.forEach(V=>{const X=Math.abs(y[V].x-D[j-1][V].x),Y=Math.abs(y[V].y-D[j-1][V].y);(X>Y?X:Y)>2&&(W=!0)}),W&&x++}}),x>=3):!1}function K(a=!1){const D=me([5,6]);if(w.value){N();return}c.value!==t.value&&(c.value=t.value,!D||a?_.value||(_.value=setInterval(()=>{if(i.value=i.value?i.value+1:1,i.value===3)d("keepMoving");else if(i.value===6)d("keepMoving");else if(i.value===9&&t.value>10){let y=5;clearInterval(m.value),m.value=setInterval(()=>{y>0?(y<=3?d(y):y===5&&d("endsoon"),y--):(d("timeOut"),clearInterval(_.value),clearInterval(m.value),w.value=!0,r.value=!1,i.value=0,_.value=void 0,ve(),N(),ie())},1e3)}},1e3)):(clearInterval(_.value),clearInterval(m.value),i.value=0,_.value=void 0))}return{num:e,time:t,countDownSrc:I,countDown:l,gameStart:r,gameEnd:w,showTip:n,startSport:U,isOutScreen:K,reStartTimer:g,reStartCountDown:b,resetSport:G,notMovingTimerInt:_,notMovingTimer:i,timer:v,rate:R,integral:P}}const Oe={id:"sport-model"},Pe={class:"fetch-box"},Ne={src:"https://yunketang-file.dream-sports.cn/static/ready_tips_positive.png",class:"img-tips"},Ve=Me({__name:"index",setup(f){const M=De(),{num:s,time:k,countDownSrc:S,countDown:h,gameStart:p,gameEnd:n,showTip:e,startSport:l,isOutScreen:I,reStartTimer:t,reStartCountDown:c,resetSport:r,rate:w,integral:v}=Ae(),T=m=>{if(m.length>0){let g=m[0].keypoints,b=.2,R=[0,1,5,6,11,15,12,16];if(k.value<=0&&(n.value=!0,t.value=setInterval(()=>{c.value>1?c.value-=1:(clearInterval(t.value),r())})),n.value)return;l(g,b,R)}else p.value&&!n.value&&I(!0)},B=m=>{m&&p.value&&!n.value&&I(!0),e.value=!0},i=()=>{M.back()},_=()=>{r()};return(m,g)=>{const b=Se,R=fe,P=_e,d=de;return $(),ke("div",Oe,[ee(b,{onUpdate:T,onError:B}),ee(R,{score:u(s),"game-duration":u(k)},null,8,["score","game-duration"]),u(h)?($(),te(P,{key:0,"start-count-down":u(S)},null,8,["start-count-down"])):ae("",!0),u(n)?($(),te(d,{key:1,modelValue:u(s),"onUpdate:modelValue":g[0]||(g[0]=U=>be(s)?s.value=U:null),rate:u(w),integral:u(v),reStartCountDown:u(c),onBack:i,onRestart:_},null,8,["modelValue","rate","integral","reStartCountDown"])):ae("",!0),ne(le("div",Pe,null,512),[[oe,!u(n)&&!u(p)||u(e)]]),ne(le("img",Ne,null,512),[[oe,u(e)&&!u(n)]])])}}});const He=Te(Ve,[["__scopeId","data-v-11fa41ea"]]);export{He as default};
