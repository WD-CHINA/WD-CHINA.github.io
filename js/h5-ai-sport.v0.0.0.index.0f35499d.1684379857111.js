var W=(r,f,n)=>new Promise((_,c)=>{var d=a=>{try{l(n.next(a))}catch(o){c(o)}},p=a=>{try{l(n.throw(a))}catch(o){c(o)}},l=a=>a.done?_(a.value):Promise.resolve(a.value).then(d,p);l((n=n.apply(r,f)).next())});import{_ as re}from"./h5-ai-sport.v0.0.0.GameOverDialog.c9df0113.1684379857111.js";import{_ as ve,a as ce}from"./h5-ai-sport.v0.0.0.GameCounter.7a2beafd.1684379857111.js";import{s as ie,c as me,_ as fe}from"./h5-ai-sport.v0.0.0.utils.de482c22.1684379857111.js";import{m as e,o as _e,M as de,N as pe,O as ge,d as he,c as z,e as Se,j as X,y as u,L as Y,P as Z,Q as Ie,R as $,S as Q,v as q,z as we,b as ye,_ as De}from"./h5-ai-sport.v0.0.0.index.a6c8dc0f.1684379857111.js";import{v as ae,s as Me,a as ee,b as Te}from"./h5-ai-sport.v0.0.0.bgAudio.47f05ebc.1684379857111.js";import{u as be}from"./h5-ai-sport.v0.0.0.Setting.b13cabb0.1684379857111.js";import"./h5-ai-sport.v0.0.0.index.92382d81.1684379857111.js";const ke=(r,f,n,_,c,d,p,l)=>{const a=Math.abs(r[13].y+r[14].y-r[11].y-r[12].y)/2,o=(r[11].y+r[12].y)/2;if(f.value.at(-1)===!1&&n.value)o>d.value&&(n.value=!1,f.value.push(!0));else if(f.value.at(-1)===!0&&!n.value){c.value===0&&(p.value=a,d.value=o-a/9,l.value=o-a/9);const h=(r[11].y+r[12].y)/2;(c.value===0||h<l.value)&&_.value&&(c.value+=1,c.value&&ae("https://go-ran-pic.lovedabai.com/sound/Sport_Ball_appear.mp3"),f.value.push(!1),_.value=!1,n.value=!0,setTimeout(()=>{_.value=!0},100))}};function xe(){const r=be(),f=pe(),n=60,_=["appear","tooClose","start","timeOut","comeOn","5","4","3","2","1","keepMoving","endsoon","adjustAngle"],c={};let d=[];const p=[1,2,3],l=e(!0),a=e(0),o=e(0),h=e(3),s=e(n),b=e(0),y=e(!1),x=e(!1),S=e(),D=e(),B=e(),v=e(),i=e(),M=e(),m=e(),I=e(10),C=e([!1]),E=e(!0),O=e(!0),R=e(0),L=e(0),V=e(0),F=e(0),G=e(0);_e(()=>{_.forEach(t=>{const k=t==="appear"?"Sport_Ball_appear":t;c[t]=`https://go-ran-pic.lovedabai.com/sound/${k}.mp3`})}),de(()=>{U(),Me(),ee()});const g=t=>{ae(c[`${t}`])},te=(t,k,T)=>{d=ie(t),me(t,k,T)&&(!y.value&&!S.value?(o.value=3,h.value=p.at(-1),ne()):o.value||(l.value=!1,ke(t,C,E,O,a,V,F,G),A()))},le=()=>{a.value>=1&&ge({code:f.name,score:a.value>0?a.value-1:0,time:n-s.value,photos:[]}).then(t=>{R.value=t.result.exceedRate?Number((t.result.exceedRate*100).toFixed(2)):0,L.value=t.result.integral})},ne=()=>{let t=3;l.value=!1,clearInterval(D.value),D.value=setInterval(()=>W(this,null,function*(){t>0?(yield g(t),yield t--):(g("start"),clearInterval(D.value),r.bgMusic&&Te("https://yunketang-file.dream-sports.cn/sound/sport_background_music_03.mp3"))}),1e3),S.value=setInterval(()=>{o.value>0?(o.value--,h.value=p[o.value===2?1:0]):(clearInterval(S.value),S.value=void 0,o.value=0,y.value=!0,oe())},1e3)},oe=()=>{B.value=setInterval(()=>{s.value>0?(s.value===21&&g("comeOn"),s.value--,s.value==0?g("timeOut"):s.value<=5&&g(s.value)):(clearInterval(B.value),P())},1e3)},ue=()=>{m.value=setInterval(()=>{I.value>1?I.value-=1:(clearInterval(m.value),U())},1e3)},P=()=>{clearInterval(D.value),clearInterval(S.value),clearInterval(B.value),clearInterval(v.value),clearInterval(i.value),clearInterval(M.value),clearInterval(m.value),D.value=void 0,S.value=void 0,B.value=void 0,v.value=0,i.value=void 0,M.value=void 0,m.value=void 0};function U(){d=[],l.value=!0,a.value=0,s.value=n,o.value=0,h.value=3,b.value=0,y.value=!1,x.value=!1,I.value=10,C.value=[!1],E.value=!0,O.value=!0,V.value=0,F.value=0,G.value=0,P(),ee()}function se(t){if(a.value===0)return!0;let k=0;const T=d.slice(-5);return T.length===5?(T.forEach((w,j)=>{if(j!==0){let H=!1;t.forEach(N=>{const J=Math.abs(w[N].x-T[j-1][N].x),K=Math.abs(w[N].y-T[j-1][N].y);(J>K?J:K)>2&&(H=!0)}),H&&k++}}),k>=3):!1}function A(t=!1){const T=se([11,12]);if(x.value){P();return}b.value!==s.value&&(b.value=s.value,!T||t?i.value||(i.value=setInterval(()=>{if(v.value=v.value?v.value+1:1,v.value===3)g("keepMoving");else if(v.value===6)g("keepMoving");else if(v.value===9&&s.value>10){let w=5;clearInterval(M.value),M.value=setInterval(()=>{w>0?(w<=3?g(w):w===5&&g("endsoon"),w--):(g("timeOut"),clearInterval(i.value),clearInterval(M.value),x.value=!0,y.value=!1,v.value=0,i.value=void 0,le(),P(),ue())},1e3)}},1e3)):(clearInterval(i.value),clearInterval(M.value),v.value=0,i.value=void 0))}return{num:a,time:s,countDownSrc:h,countDown:o,gameStart:y,gameEnd:x,showTip:l,startSport:te,isOutScreen:A,reStartTimer:m,reStartCountDown:I,resetSport:U,notMovingTimerInt:i,notMovingTimer:v,timer:S,rate:R,integral:L,hip_knee_mid_line:V,halfLegLength:F,hip_top_line:G}}const Be={id:"sport-model"},Ce={class:"fetch-box"},Ee={src:"https://yunketang-file.dream-sports.cn/static/ready_tips_positive.png",class:"img-tips"},Oe=he({__name:"index",setup(r){const f=ye(),{num:n,time:_,countDownSrc:c,countDown:d,gameStart:p,gameEnd:l,showTip:a,startSport:o,isOutScreen:h,reStartTimer:s,reStartCountDown:b,resetSport:y,rate:x,integral:S,hip_knee_mid_line:D}=xe(),B=m=>{if(m.length>0){let I=m[0].keypoints,C=.2,E=[11,12];if(_.value<=0&&(l.value=!0,s.value=setInterval(()=>{b.value>1?b.value-=1:(clearInterval(s.value),y())})),l.value)return;o(I,C,E)}else p.value&&!l.value&&h(!0)},v=m=>{m&&p.value&&!l.value&&h(!0),a.value=!0},i=()=>{f.back()},M=()=>{y()};return(m,I)=>{const C=fe,E=ve,O=ce,R=re;return z(),Se("div",Be,[X(C,{onUpdate:B,onError:v}),X(E,{score:u(n),"game-duration":u(_)},null,8,["score","game-duration"]),u(d)?(z(),Y(O,{key:0,"start-count-down":u(c)},null,8,["start-count-down"])):Z("",!0),u(l)?(z(),Y(R,{key:1,modelValue:u(n),"onUpdate:modelValue":I[0]||(I[0]=L=>Ie(n)?n.value=L:null),rate:u(x),integral:u(S),reStartCountDown:u(b),onBack:i,onRestart:M},null,8,["modelValue","rate","integral","reStartCountDown"])):Z("",!0),$(q("div",Ce,null,512),[[Q,!u(l)&&!u(p)||u(a)]]),$(q("div",{class:"hip_knee_mid_line",style:we("top:"+u(D)+"px !important")},null,4),[[Q,u(D)&&!u(l)]]),$(q("img",Ee,null,512),[[Q,u(a)&&!u(l)]])])}}});const ze=De(Oe,[["__scopeId","data-v-04f3efd0"]]);export{ze as default};
