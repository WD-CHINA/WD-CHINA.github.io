var Q=(w,_,n)=>new Promise((d,p)=>{var g=e=>{try{l(n.next(e))}catch(o){p(o)}},i=e=>{try{l(n.throw(e))}catch(o){p(o)}},l=e=>e.done?d(e.value):Promise.resolve(e.value).then(g,i);l((n=n.apply(w,_)).next())});import{_ as se}from"./h5-ai-sport.v0.0.0.GameOverDialog.c9df0113.1684379857111.js";import{_ as ue,a as re}from"./h5-ai-sport.v0.0.0.GameCounter.7a2beafd.1684379857111.js";import{s as ce,c as ve,_ as ie}from"./h5-ai-sport.v0.0.0.utils.de482c22.1684379857111.js";import{m as a,o as fe,M as me,N as _e,O as de,d as pe,c as j,e as ge,j as q,y as u,L as z,P as A,Q as he,R as H,S as J,v as K,b as Se,_ as Ie}from"./h5-ai-sport.v0.0.0.index.a6c8dc0f.1684379857111.js";import{v as Y,s as we,a as W,b as be}from"./h5-ai-sport.v0.0.0.bgAudio.47f05ebc.1684379857111.js";import{u as ye}from"./h5-ai-sport.v0.0.0.Setting.b13cabb0.1684379857111.js";import"./h5-ai-sport.v0.0.0.index.92382d81.1684379857111.js";const Me=(w,_,n,d,p,g)=>{const i=w[9].x,l=w[10].x,e=w[5].x,o=w[6].x;_.value.at(-1)===!1&&n.value?Math.abs(i-l)<Math.abs(e-o)*1.2&&g([13,14])&&d.value&&(p.value+=1,_.value.push(!0),d.value=!1,n.value=!1,p.value&&Y("https://go-ran-pic.lovedabai.com/sound/Sport_Ball_appear.mp3")):_.value.at(-1)===!0&&!n.value&&Math.abs(i-l)>Math.abs(e-o)*2.5&&(_.value.push(!1),d.value=!0,n.value=!0)};function ke(){const w=ye(),_=_e(),n=60,d=["appear","tooClose","start","timeOut","comeOn","5","4","3","2","1","keepMoving","endsoon","adjustAngle"],p={};let g=[];const i=[1,2,3],l=a(!0),e=a(0),o=a(0),k=a(3),s=a(n),x=a(0),y=a(!1),B=a(!1),b=a(),D=a(),C=a(),r=a(),f=a(),c=a(),h=a(),M=a(10),E=a([!1]),P=a(!0),F=a(!0),N=a(0),L=a(0);fe(()=>{d.forEach(t=>{const I=t==="appear"?"Sport_Ball_appear":t;p[t]=`https://go-ran-pic.lovedabai.com/sound/${I}.mp3`})}),me(()=>{X(),we(),W()});const S=t=>{Y(p[`${t}`])},Z=(t,I,v)=>{g=ce(t),ve(t,I,v)&&(!y.value&&!b.value?(o.value=3,k.value=i.at(-1),ae()):o.value||(l.value=!1,Me(t,E,P,F,e,ee),$()))};function ee(t){if(e.value===0)return!0;let I=0;const v=g.slice(-5);return v.length===5?(v.forEach((m,O)=>{if(O!==0){let R=!1;t.forEach(T=>{Math.abs(m[T].y-v[O-1][T].y)>2&&(R=!0)}),R&&I++}}),I>=3):!1}const te=()=>{e.value>=1&&de({code:_.name,score:e.value>0?e.value-1:0,time:n-s.value,photos:[]}).then(t=>{N.value=t.result.exceedRate?Number((t.result.exceedRate*100).toFixed(2)):0,L.value=t.result.integral})},ae=()=>{let t=3;l.value=!1,clearInterval(D.value),D.value=setInterval(()=>Q(this,null,function*(){t>0?(yield S(t),yield t--):(S("start"),clearInterval(D.value),w.bgMusic&&be("https://yunketang-file.dream-sports.cn/sound/sport_background_music_03.mp3"))}),1e3),b.value=setInterval(()=>{o.value>0?(o.value--,k.value=i[o.value===2?1:0]):(clearInterval(b.value),b.value=void 0,o.value=0,y.value=!0,le())},1e3)},le=()=>{C.value=setInterval(()=>{s.value>0?(s.value===21&&S("comeOn"),s.value--,s.value==0?S("timeOut"):s.value<=5&&S(s.value)):(clearInterval(C.value),V())},1e3)},ne=()=>{h.value=setInterval(()=>{M.value>1?M.value-=1:(clearInterval(h.value),X())},1e3)},V=()=>{clearInterval(D.value),clearInterval(b.value),clearInterval(C.value),clearInterval(r.value),clearInterval(f.value),clearInterval(c.value),clearInterval(h.value),D.value=void 0,b.value=void 0,C.value=void 0,r.value=0,f.value=void 0,c.value=void 0,h.value=void 0};function X(){g=[],l.value=!0,e.value=0,s.value=n,o.value=0,k.value=3,x.value=0,y.value=!1,B.value=!1,M.value=10,E.value=[!1],P.value=!0,F.value=!0,V(),W()}function oe(t){if(e.value===0)return!0;let I=0;const v=g.slice(-5);return v.length===5?(v.forEach((m,O)=>{if(O!==0){let R=!1;t.forEach(T=>{const G=Math.abs(m[T].x-v[O-1][T].x),U=Math.abs(m[T].y-v[O-1][T].y);(G>U?G:U)>2&&(R=!0)}),R&&I++}}),I>=3):!1}function $(t=!1){const v=oe([13,14]);if(B.value){V();return}x.value!==s.value&&(x.value=s.value,!v||t?f.value||(f.value=setInterval(()=>{if(r.value=r.value?r.value+1:1,r.value===3)S("keepMoving");else if(r.value===6)S("keepMoving");else if(r.value===9&&s.value>10){let m=5;clearInterval(c.value),c.value=setInterval(()=>{m>0?(m<=3?S(m):m===5&&S("endsoon"),m--):(S("timeOut"),clearInterval(f.value),clearInterval(c.value),B.value=!0,y.value=!1,r.value=0,f.value=void 0,te(),V(),ne())},1e3)}},1e3)):(clearInterval(f.value),clearInterval(c.value),r.value=0,f.value=void 0))}return{num:e,time:s,countDownSrc:k,countDown:o,gameStart:y,gameEnd:B,showTip:l,startSport:Z,isOutScreen:$,reStartTimer:h,reStartCountDown:M,resetSport:X,notMovingTimerInt:f,notMovingTimer:r,timer:b,rate:N,integral:L}}const xe={id:"sport-model"},De={class:"fetch-box"},Te={src:"https://yunketang-file.dream-sports.cn/static/ready_tips_positive.png",class:"img-tips"},Be=pe({__name:"index",setup(w){const _=Se(),{num:n,time:d,countDownSrc:p,countDown:g,gameStart:i,gameEnd:l,showTip:e,startSport:o,isOutScreen:k,reStartTimer:s,reStartCountDown:x,resetSport:y,rate:B,integral:b}=ke(),D=c=>{if(c.length>0){let h=c[0].keypoints,M=.2,E=[0,1,5,6,11,15,12,16];if(d.value<=0&&(l.value=!0,s.value=setInterval(()=>{x.value>1?x.value-=1:(clearInterval(s.value),y())})),l.value)return;o(h,M,E)}else i.value&&!l.value&&k(!0)},C=c=>{c&&i.value&&!l.value&&k(!0),e.value=!0},r=()=>{_.back()},f=()=>{y()};return(c,h)=>{const M=ie,E=ue,P=re,F=se;return j(),ge("div",xe,[q(M,{onUpdate:D,onError:C}),q(E,{score:u(n),"game-duration":u(d)},null,8,["score","game-duration"]),u(g)?(j(),z(P,{key:0,"start-count-down":u(p)},null,8,["start-count-down"])):A("",!0),u(l)?(j(),z(F,{key:1,modelValue:u(n),"onUpdate:modelValue":h[0]||(h[0]=N=>he(n)?n.value=N:null),rate:u(B),integral:u(b),reStartCountDown:u(x),onBack:r,onRestart:f},null,8,["modelValue","rate","integral","reStartCountDown"])):A("",!0),H(K("div",De,null,512),[[J,!u(l)&&!u(i)||u(e)]]),H(K("img",Te,null,512),[[J,u(e)&&!u(l)]])])}}});const Ge=Ie(Be,[["__scopeId","data-v-ca01eb67"]]);export{Ge as default};
