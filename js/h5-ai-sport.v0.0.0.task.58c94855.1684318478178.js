import{d as G,b as H,u as M,m as i,o as O,c as s,e as t,j as _,x as m,C as g,a2 as k,v as a,V as q,A as n,P as c,B as S,z as J,L as K,a5 as Q,D as W,E as X,G as Y,_ as Z}from"./h5-ai-sport.v0.0.0.index.95bda2e2.1684318478178.js";import{a as ee,T as se}from"./h5-ai-sport.v0.0.0.index.c132801b.1684318478178.js";import{L as te}from"./h5-ai-sport.v0.0.0.index.78283ae5.1684318478178.js";import{a as ae}from"./h5-ai-sport.v0.0.0.teacher.cc7b4fdd.1684318478178.js";import{u as oe}from"./h5-ai-sport.v0.0.0.Task.bb83b96b.1684318478178.js";import{I as ne}from"./h5-ai-sport.v0.0.0.index.9c59126a.1684318478178.js";import"./h5-ai-sport.v0.0.0.use-id.63b167f5.1684318478178.js";import"./h5-ai-sport.v0.0.0.use-tab-status.b97a6de6.1684318478178.js";import"./h5-ai-sport.v0.0.0.index.1828ee52.1684318478178.js";const le=v=>(X("data-v-e1e8334a"),v=v(),Y(),v),ie={class:"project"},ce={class:"taskListBox"},de=["onClick"],re={class:"taskItem_left"},ue={key:0,style:{width:"100%"}},_e={class:"number",style:{width:"100%",overflow:"hidden","text-overflow":"ellipsis"}},ve={class:"numberName"},pe={key:1},me={class:"number"},he=le(()=>a("span",{class:"numberName"},"班",-1)),fe={class:"taskItem_right"},ge={class:"right_title"},ke={class:"proName ellipsis"},ye={class:"dayNum"},Ne={key:0},be={class:"proDate"},Ce={class:"doneInfo"},xe={key:0,class:"doneNum"},Ie={key:1,class:"doneNum"},Le={key:2,class:"doneNum"},Se={key:3,class:"imgBox"},Be={key:0,class:"imgList"},De={key:1,class:"noProject"},Re={key:0},Te=G({__name:"task",setup(v){const y=H(),B=oe(),D=M(),R=[{name:"进行中",status:"todo"},{name:"已结束",status:"done"}],T=i(0),l=i("todo"),d=i([]),N=i(D.userInfo.roleCode!=="ROLE_TEACHER"),p=i(!1),h=i(!1),f=i(1),w=i(10),b=i(0);O(()=>{b.value=document.getElementsByClassName("van-nav-bar--fixed")[0].getBoundingClientRect().height});const C=()=>{ae({status:l.value,pageNo:f.value,pageSize:w.value}).then(r=>{d.value.length>=r.result.total?h.value=!0:(r.result.rows.forEach(o=>{o.startDate=o.startDate.slice(0,10).replace(/-/g,"."),o.finishRateStr=o.finishRate?parseFloat((o.finishRate*100).toFixed(1)):0,o.gameNames=o.gameNames.split(",")}),f.value+=1,p.value=!1,d.value.push(...r.result.rows))})},E=()=>{d.value=[],p.value=!1,h.value=!1,f.value=1,C()},x=()=>{B.$reset(),y.push("/create/task")},j=r=>{y.push(`/taskdetails/details/${r.id}`)};return(r,o)=>{const z=Q,P=te,V=ee,U=se,A=ne,F=W;return s(),t("div",ie,[_(U,{sticky:"","offset-top":b.value,active:l.value,"onUpdate:active":o[1]||(o[1]=u=>l.value=u),background:"#0074E8","title-active-color":"#fff",onChange:E},{default:m(()=>[(s(),t(g,null,k(R,u=>_(V,{key:u.status,name:u.status,title:u.name},{default:m(()=>[_(P,{loading:p.value,"onUpdate:loading":o[0]||(o[0]=e=>p.value=e),"loading-text":" ",finished:h.value,"finished-text":"",onLoad:C},{default:m(()=>[a("div",ce,[(s(!0),t(g,null,k(d.value,(e,I)=>(s(),t("div",{class:"taskItem",onClick:L=>j(e),key:I},[a("div",re,[a("div",{class:q("left_icon c"+I%4)},[e.numberName?(s(),t("div",ue,[a("div",_e,[a("div",ve,n(e.numberName),1)])])):e.number?(s(),t("div",pe,[a("div",me,[a("span",null,n(e.number),1),he])])):c("",!0)],2),a("div",null,n(e.gradeName||e.grade+"年级"),1)]),a("div",fe,[a("div",ge,[a("div",ke,n(e.name),1),a("div",ye,[e.currentDays?(s(),t("span",Ne,n(e.currentDays)+"/",1)):c("",!0),S(" "+n(e.days)+"天 ",1)])]),a("div",be,n(e.startDate),1),a("div",Ce,[e.currentDays&&l.value=="todo"?(s(),t("div",xe,n(e.type=="day"?"今日":"本周")+"完成："+n(e.finishCount)+"/"+n(e.total)+"人 ",1)):l.value=="todo"?(s(),t("div",Ie,"暂未开始")):(s(),t("div",Le,"完成度："+n(e.finishRateStr>=0?e.finishRateStr:0)+"%",1)),T.value<=2?(s(),t("div",Se,[(s(!0),t(g,null,k(e.gameNames,(L,$)=>(s(),t("div",{class:"imgList",style:J("background-image:url(https://yunketang-file.dream-sports.cn/static/"+L+".png)"),key:$},null,4))),128)),e.gameNames.length>3?(s(),t("div",Be,[_(z,{name:"ellipsis",color:"#fff",size:"30px"})])):c("",!0)])):c("",!0)])])],8,de))),128))])]),_:1},8,["loading","finished"])]),_:2},1032,["name","title"])),64))]),_:1},8,["offset-top","active"]),l.value!="todo"||!d.value.length?c("",!0):(s(),t("div",{key:0,class:"floatAddPro",onClick:x})),d.value.length?c("",!0):(s(),t("div",De,[_(A,{src:"https://yunketang-file.dream-sports.cn/static/noProjectImg.png"}),a("div",null,"当前暂无"+n(l.value==="todo"?"":"已结束")+"运动计划",1),l.value==="todo"&&!N.value?(s(),t("div",Re,"去创建学生们的体育运动计划吧")):c("",!0),l.value==="todo"&&!N.value?(s(),K(F,{key:1,icon:"plus",onClick:x,class:"addProjectBtn"},{default:m(()=>[S("创建计划")]),_:1})):c("",!0)]))])}}});const $e=Z(Te,[["__scopeId","data-v-e1e8334a"]]);export{$e as default};
