var H=(m,d,l)=>new Promise((f,v)=>{var _=t=>{try{o(l.next(t))}catch(u){v(u)}},c=t=>{try{o(l.throw(t))}catch(u){v(u)}},o=t=>t.done?f(t.value):Promise.resolve(t.value).then(_,c);o((l=l.apply(m,d)).next())});import{_ as se}from"./h5-ai-sport.v0.0.0.GameOverDialog.6627159e.1684379358906.js";import{_ as re,a as ve}from"./h5-ai-sport.v0.0.0.GameCounter.37fff7f2.1684379358906.js";import{s as ce,c as ie,_ as me}from"./h5-ai-sport.v0.0.0.utils.818e0269.1684379358906.js";import{m as a,o as fe,M as J,N as _e,O as pe,d as de,c as G,e as ge,j as K,y as s,L as W,P as X,Q as he,R as Y,S as Z,v as A,b as Se,_ as Ie}from"./h5-ai-sport.v0.0.0.index.eb36d521.1684379358906.js";import{v as j,s as ee,a as U,b as we}from"./h5-ai-sport.v0.0.0.bgAudio.9e45de03.1684379358906.js";import{u as ye}from"./h5-ai-sport.v0.0.0.Setting.35b97f7f.1684379358906.js";import"./h5-ai-sport.v0.0.0.index.1a7b6993.1684379358906.js";const ke=(m,d,l,f,v)=>{const _=m[13].y,c=m[14].y,o=Number((Math.random()*.2+.3).toFixed(1));d.value.at(-1)===!1&&l.value?c/_>1.03&&c>(m[11].y+m[12].y)/2*1.1&&f.value&&(v.value+=Math.ceil(1+o),d.value.push(!0),f.value=!1,l.value=!1,v.value&&j("https://go-ran-pic.lovedabai.com/sound/Sport_Ball_appear.mp3")):d.value.at(-1)===!0&&!l.value&&_/c>1.03&&_>(m[11].y+m[12].y)/2*1.1&&(f.value||(v.value+=1,d.value.push(!1),f.value=!0,l.value=!0,v.value&&j("https://go-ran-pic.lovedabai.com/sound/Sport_Ball_appear.mp3")))};function Me(){const m=ye(),d=_e(),l=60,f=["appear","tooClose","start","timeOut","comeOn","5","4","3","2","1","keepMoving","endsoon","adjustAngle"],v={};let _=[];const c=[1,2,3],o=a(!0),t=a(0),u=a(0),M=a(3),n=a(l),b=a(0),w=a(!1),B=a(!1),S=a(),D=a(),T=a(),r=a(),p=a(),i=a(),g=a(),y=a(10),C=a(0),E=a(0),O=a([!1]),R=a(!0),L=a(!0);fe(()=>{f.forEach(e=>{const x=e==="appear"?"Sport_Ball_appear":e;v[e]=`https://go-ran-pic.lovedabai.com/sound/${x}.mp3`})}),J(()=>{P(),ee(),U()}),J(()=>{P(),ee(),U()});const h=e=>{j(v[`${e}`])},ae=(e,x,k)=>{_=ce(e),ie(e,x,k)&&(!w.value&&!S.value?(u.value=3,M.value=c.at(-1),te()):u.value||(o.value=!1,ke(e,O,R,L,t),$()))},te=()=>{let e=3;o.value=!1,clearInterval(D.value),D.value=setInterval(()=>H(this,null,function*(){e>0?(yield h(e),yield e--):(h("start"),clearInterval(D.value),m.bgMusic&&we("https://yunketang-file.dream-sports.cn/sound/sport_background_music_03.mp3"))}),1e3),S.value=setInterval(()=>{u.value>0?(u.value--,M.value=c[u.value===2?1:0]):(clearInterval(S.value),S.value=void 0,u.value=0,w.value=!0,le())},1e3)},le=()=>{T.value=setInterval(()=>{n.value>0?(n.value===21&&h("comeOn"),n.value--,n.value==0?h("timeOut"):n.value<=5&&h(n.value)):(clearInterval(T.value),N())},1e3)},oe=()=>{g.value=setInterval(()=>{y.value>1?y.value-=1:(clearInterval(g.value),P())},1e3)},N=()=>{clearInterval(D.value),clearInterval(S.value),clearInterval(T.value),clearInterval(r.value),clearInterval(p.value),clearInterval(i.value),clearInterval(g.value),D.value=void 0,S.value=void 0,T.value=void 0,r.value=0,p.value=void 0,i.value=void 0,g.value=void 0};function P(){_=[],o.value=!0,t.value=0,n.value=l,u.value=0,M.value=3,b.value=0,w.value=!1,B.value=!1,y.value=10,O.value=[!1],R.value=!0,L.value=!0,N(),U()}const ne=()=>{t.value>=1&&pe({code:d.name,score:t.value>0?t.value-1:0,time:l-n.value,photos:[]}).then(e=>{C.value=e.result.exceedRate?Number((e.result.exceedRate*100).toFixed(2)):0,E.value=e.result.integral})};function ue(e){if(t.value===0)return!0;let x=0;const k=_.slice(-5);return k.length===5?(k.forEach((I,V)=>{if(V!==0){let Q=!1;e.forEach(F=>{const q=Math.abs(I[F].x-k[V-1][F].x),z=Math.abs(I[F].y-k[V-1][F].y);(q>z?q:z)>2&&(Q=!0)}),Q&&x++}}),x>=3):!1}function $(e=!1){const k=ue([13,14]);if(B.value){N();return}b.value!==n.value&&(b.value=n.value,!k||e?p.value||(p.value=setInterval(()=>{if(r.value=r.value?r.value+1:1,r.value===3)h("keepMoving");else if(r.value===6)h("keepMoving");else if(r.value===9&&n.value>10){let I=5;clearInterval(i.value),i.value=setInterval(()=>{I>0?(I<=3?h(I):I===5&&h("endsoon"),I--):(h("timeOut"),clearInterval(p.value),clearInterval(i.value),B.value=!0,w.value=!1,r.value=0,p.value=void 0,ne(),N(),oe())},1e3)}},1e3)):(clearInterval(p.value),clearInterval(i.value),r.value=0,p.value=void 0))}return{num:t,time:n,countDownSrc:M,countDown:u,gameStart:w,gameEnd:B,showTip:o,startSport:ae,isOutScreen:$,reStartTimer:g,reStartCountDown:y,resetSport:P,notMovingTimerInt:p,notMovingTimer:r,timer:S,rate:C,integral:E}}const be={id:"sport-model"},De={class:"fetch-box"},xe={src:"https://yunketang-file.dream-sports.cn/static/ready_tips_positive.png",class:"img-tips"},Be=de({__name:"index",setup(m){const d=Se(),{num:l,time:f,countDownSrc:v,countDown:_,gameStart:c,gameEnd:o,showTip:t,startSport:u,isOutScreen:M,reStartTimer:n,reStartCountDown:b,resetSport:w,rate:B,integral:S}=Me(),D=i=>{if(i.length>0){let g=i[0].keypoints,y=.2,C=[0,1,5,6,11,15,12,16];if(f.value<=0&&(o.value=!0,n.value=setInterval(()=>{b.value>1?b.value-=1:(clearInterval(n.value),w())})),o.value)return;u(g,y,C)}else c.value&&!o.value&&M(!0)},T=i=>{i&&c.value&&!o.value&&M(!0),t.value=!0},r=()=>{d.back()},p=()=>{w()};return(i,g)=>{const y=me,C=re,E=ve,O=se;return G(),ge("div",be,[K(y,{onUpdate:D,onError:T}),K(C,{score:s(l),"game-duration":s(f)},null,8,["score","game-duration"]),s(_)?(G(),W(E,{key:0,"start-count-down":s(v)},null,8,["start-count-down"])):X("",!0),s(o)?(G(),W(O,{key:1,modelValue:s(l),"onUpdate:modelValue":g[0]||(g[0]=R=>he(l)?l.value=R:null),rate:s(B),integral:s(S),reStartCountDown:s(b),onBack:r,onRestart:p},null,8,["modelValue","rate","integral","reStartCountDown"])):X("",!0),Y(A("div",De,null,512),[[Z,!s(o)&&!s(c)||s(t)]]),Y(A("img",xe,null,512),[[Z,s(t)&&!s(o)]])])}}});const Ge=Ie(Be,[["__scopeId","data-v-7019569e"]]);export{Ge as default};
