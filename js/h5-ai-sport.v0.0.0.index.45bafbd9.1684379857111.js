var W=(o,m,l)=>new Promise((f,_)=>{var x=t=>{try{n(l.next(t))}catch(s){_(s)}},S=t=>{try{n(l.throw(t))}catch(s){_(s)}},n=t=>t.done?f(t.value):Promise.resolve(t.value).then(x,S);n((l=l.apply(o,m)).next())});import{_ as re,a as ve,b as ce}from"./h5-ai-sport.v0.0.0.GameCounterHorizontal.537a709e.1684379857111.js";import{d as R,s as ie,b as me,i as fe,_ as _e}from"./h5-ai-sport.v0.0.0.utils.de482c22.1684379857111.js";import{m as a,o as de,M as Y,N as pe,O as ge,d as he,c as G,e as Ie,j as q,y as r,L as H,P as J,Q as Se,R as K,S as X,v as Z,b as we,_ as be}from"./h5-ai-sport.v0.0.0.index.a6c8dc0f.1684379857111.js";import{v as ae,s as ee,a as U,b as xe}from"./h5-ai-sport.v0.0.0.bgAudio.47f05ebc.1684379857111.js";import{u as De}from"./h5-ai-sport.v0.0.0.Setting.b13cabb0.1684379857111.js";import"./h5-ai-sport.v0.0.0.index.92382d81.1684379857111.js";const Me=(o,m,l,f,_)=>{console.log(R(o[5],o[11])),m.value.at(-1)===!1&&l.value?f.value&&R(o[5],o[11])<15&&R(o[6],o[12])<15&&(_.value+=1,m.value.push(!0),f.value=!1,l.value=!1,_.value&&ae("https://go-ran-pic.lovedabai.com/sound/Sport_Ball_appear.mp3")):m.value.at(-1)===!0&&!l.value&&R(o[5],o[11])>70&&R(o[6],o[12])>70&&(m.value.push(!1),f.value=!0,l.value=!0)};function Be(){const o=De(),m=pe(),l=60,f=["appear","tooClose","start","timeOut","comeOn","5","4","3","2","1","keepMoving","endsoon","adjustAngle"],_={};let x=[];const S=[1,2,3],n=a(!0),t=a(0),s=a(0),D=a(3),u=a(l),M=a(0),w=a(!1),C=a(!1),g=a(),B=a(),E=a(),v=a(),i=a(),c=a(),d=a(),b=a(10),O=a(0),y=a(0),N=a([!1]),P=a(!0),j=a(!0);de(()=>{f.forEach(e=>{const T=e==="appear"?"Sport_Ball_appear":e;_[e]=`https://go-ran-pic.lovedabai.com/sound/${T}.mp3`})}),Y(()=>{F(),ee(),U()}),Y(()=>{F(),ee(),U()});const p=e=>{ae(_[`${e}`])},te=(e,T,h)=>{x=ie(e),me(e,T,h)&&fe(h)&&(!w.value&&!g.value&&R(e[13],e[11])>30&&Math.abs(e[5].x-e[6].x)<20?(s.value=3,D.value=S.at(-1),le()):s.value||(n.value=!1,Me(e,N,P,j,t),L()))},le=()=>{let e=3;n.value=!1,clearInterval(B.value),B.value=setInterval(()=>W(this,null,function*(){e>0?(yield p(e),yield e--):(p("start"),clearInterval(B.value),o.bgMusic&&xe("https://yunketang-file.dream-sports.cn/sound/sport_background_music_03.mp3"))}),1e3),g.value=setInterval(()=>{s.value>0?(s.value--,D.value=S[s.value===2?1:0]):(clearInterval(g.value),g.value=void 0,s.value=0,w.value=!0,ne())},1e3)},ne=()=>{E.value=setInterval(()=>{u.value>0?(u.value===21&&p("comeOn"),u.value--,u.value==0?p("timeOut"):u.value<=5&&p(u.value)):(clearInterval(E.value),V())},1e3)},oe=()=>{d.value=setInterval(()=>{b.value>1?b.value-=1:(clearInterval(d.value),F())},1e3)},V=()=>{clearInterval(B.value),clearInterval(g.value),clearInterval(E.value),clearInterval(v.value),clearInterval(i.value),clearInterval(c.value),clearInterval(d.value),B.value=void 0,g.value=void 0,E.value=void 0,v.value=0,i.value=void 0,c.value=void 0,d.value=void 0};function F(){x=[],n.value=!0,t.value=0,u.value=l,s.value=0,D.value=3,M.value=0,w.value=!1,C.value=!1,b.value=10,N.value=[!1],P.value=!0,j.value=!0,V(),U()}const ue=()=>{t.value>=1&&ge({code:m.name,score:t.value>0?t.value-1:0,time:l-u.value,photos:[]}).then(e=>{O.value=e.result.exceedRate?Number((e.result.exceedRate*100).toFixed(2)):0,y.value=e.result.integral})};function se(e){if(t.value===0)return!0;let T=0;const h=x.slice(-5);return h.length===5?(h.forEach((I,z)=>{if(z!==0){let $=!1;e.forEach(k=>{const A=Math.abs(I[k].x-h[z-1][k].x),Q=Math.abs(I[k].y-h[z-1][k].y);(A>Q?A:Q)>2&&($=!0)}),$&&T++}}),T>=3):!1}function L(e=!1){const h=se([13,14]);if(C.value){V();return}M.value!==u.value&&(M.value=u.value,!h||e?i.value||(i.value=setInterval(()=>{if(v.value=v.value?v.value+1:1,v.value===3)p("keepMoving");else if(v.value===6)p("keepMoving");else if(v.value===9&&u.value>10){let I=5;clearInterval(c.value),c.value=setInterval(()=>{I>0?(I<=3?p(I):I===5&&p("endsoon"),I--):(p("timeOut"),clearInterval(i.value),clearInterval(c.value),C.value=!0,w.value=!1,v.value=0,i.value=void 0,ue(),V(),oe())},1e3)}},1e3)):(clearInterval(i.value),clearInterval(c.value),v.value=0,i.value=void 0))}return{num:t,time:u,countDownSrc:D,countDown:s,gameStart:w,gameEnd:C,showTip:n,startSport:te,isOutScreen:L,reStartTimer:d,reStartCountDown:b,resetSport:F,notMovingTimerInt:i,notMovingTimer:v,timer:g,rate:O,integral:y}}const Te={id:"sport-model"},Ce={class:"fetch-box"},Ee={src:"https://yunketang-file.dream-sports.cn/static/ready_tips_positive.png",class:"img-tips"},Oe=he({__name:"index",setup(o){const m=we(),{num:l,time:f,countDownSrc:_,countDown:x,gameStart:S,gameEnd:n,showTip:t,startSport:s,isOutScreen:D,reStartTimer:u,reStartCountDown:M,resetSport:w,rate:C,integral:g}=Be(),B=c=>{if(c.length>0){let d=c[0].keypoints,b=.2,O=[0,1,5,6,11,15,12,16];if(f.value<=0&&(n.value=!0,u.value=setInterval(()=>{M.value>1?M.value-=1:(clearInterval(u.value),w())})),n.value)return;s(d,b,O)}else S.value&&!n.value&&D(!0)},E=c=>{c&&S.value&&!n.value&&D(!0),t.value=!0},v=()=>{m.back()},i=()=>{w()};return(c,d)=>{const b=_e,O=re,y=ve,N=ce;return G(),Ie("div",Te,[q(b,{onUpdate:B,onError:E}),q(O,{score:r(l),"game-duration":r(f)},null,8,["score","game-duration"]),r(x)?(G(),H(y,{key:0,"start-count-down":r(_)},null,8,["start-count-down"])):J("",!0),r(n)?(G(),H(N,{key:1,modelValue:r(l),"onUpdate:modelValue":d[0]||(d[0]=P=>Se(l)?l.value=P:null),rate:r(C),integral:r(g),reStartCountDown:r(M),onBack:v,onRestart:i},null,8,["modelValue","rate","integral","reStartCountDown"])):J("",!0),K(Z("div",Ce,null,512),[[X,!r(n)&&!r(S)||r(t)]]),K(Z("img",Ee,null,512),[[X,r(t)&&!r(n)]])])}}});const Ge=be(Oe,[["__scopeId","data-v-3c0c6464"]]);export{Ge as default};
