var z=(k,i,l)=>new Promise((m,f)=>{var y=t=>{try{n(l.next(t))}catch(u){f(u)}},S=t=>{try{n(l.throw(t))}catch(u){f(u)}},n=t=>t.done?m(t.value):Promise.resolve(t.value).then(y,S);n((l=l.apply(k,i)).next())});import{_ as re}from"./h5-ai-sport.v0.0.0.GameOverDialog.d582f100.1684318478178.js";import{_ as ve,a as ce}from"./h5-ai-sport.v0.0.0.GameCounter.ab805804.1684318478178.js";import{t as A,s as ie,c as me,_ as fe}from"./h5-ai-sport.v0.0.0.utils.18f0aaca.1684318478178.js";import{m as a,o as _e,M as H,N as pe,O as de,d as ge,c as G,e as Se,j as J,y as s,L as K,P as W,Q as Ie,R as X,S as Y,v as Z,b as he,_ as we}from"./h5-ai-sport.v0.0.0.index.95bda2e2.1684318478178.js";import{v as ae,s as ee,a as U,b as ke}from"./h5-ai-sport.v0.0.0.bgAudio.2915f8b6.1684318478178.js";import{u as ye}from"./h5-ai-sport.v0.0.0.Setting.214989f5.1684318478178.js";import"./h5-ai-sport.v0.0.0.index.9c59126a.1684318478178.js";const be=(k,i,l,m,f)=>{i.value.at(-1)===!1&&l.value?m.value&&A(k)>10&&(f.value+=1,i.value.push(!0),m.value=!1,l.value=!1,f.value&&ae("https://go-ran-pic.lovedabai.com/sound/Sport_Ball_appear.mp3")):i.value.at(-1)===!0&&!l.value&&A(k)<5&&(i.value.push(!1),m.value=!0,l.value=!0)};function De(){const k=ye(),i=pe(),l=60,m=["appear","tooClose","start","timeOut","comeOn","5","4","3","2","1","keepMoving","endsoon","adjustAngle"],f={};let y=[];const S=[1,2,3],n=a(!0),t=a(0),u=a(0),b=a(3),o=a(l),D=a(0),I=a(!1),x=a(!1),d=a(),M=a(),B=a(),r=a(),c=a(),v=a(),_=a(),h=a(10),C=a(0),E=a(0),R=a([!1]),O=a(!0),j=a(!0);_e(()=>{m.forEach(e=>{const T=e==="appear"?"Sport_Ball_appear":e;f[e]=`https://go-ran-pic.lovedabai.com/sound/${T}.mp3`})}),H(()=>{N(),ee(),U()}),H(()=>{N(),ee(),U()});const p=e=>{ae(f[`${e}`])},te=(e,T,w)=>{y=ie(e),me(e,T,w)&&(!I.value&&!d.value?(u.value=3,b.value=S.at(-1),le()):u.value||(n.value=!1,be(e,R,O,j,t),L()))},le=()=>{let e=3;n.value=!1,clearInterval(M.value),M.value=setInterval(()=>z(this,null,function*(){e>0?(yield p(e),yield e--):(p("start"),clearInterval(M.value),k.bgMusic&&ke("https://yunketang-file.dream-sports.cn/sound/sport_background_music_03.mp3"))}),1e3),d.value=setInterval(()=>{u.value>0?(u.value--,b.value=S[u.value===2?1:0]):(clearInterval(d.value),d.value=void 0,u.value=0,I.value=!0,ne())},1e3)},ne=()=>{B.value=setInterval(()=>{o.value>0?(o.value===21&&p("comeOn"),o.value--,o.value==0?p("timeOut"):o.value<=5&&p(o.value)):(clearInterval(B.value),P())},1e3)},oe=()=>{_.value=setInterval(()=>{h.value>1?h.value-=1:(clearInterval(_.value),N())},1e3)},P=()=>{clearInterval(M.value),clearInterval(d.value),clearInterval(B.value),clearInterval(r.value),clearInterval(c.value),clearInterval(v.value),clearInterval(_.value),M.value=void 0,d.value=void 0,B.value=void 0,r.value=0,c.value=void 0,v.value=void 0,_.value=void 0};function N(){y=[],n.value=!0,t.value=0,o.value=l,u.value=0,b.value=3,D.value=0,I.value=!1,x.value=!1,h.value=10,R.value=[!1],O.value=!0,j.value=!0,P(),U()}const ue=()=>{t.value>=1&&de({code:i.name,score:t.value>0?t.value-1:0,time:l-o.value,photos:[]}).then(e=>{C.value=e.result.exceedRate?Number((e.result.exceedRate*100).toFixed(2)):0,E.value=e.result.integral})};function se(e){if(t.value===0)return!0;let T=0;const w=y.slice(-5);return w.length===5?(w.forEach((g,F)=>{if(F!==0){let $=!1;e.forEach(V=>{const Q=Math.abs(g[V].x-w[F-1][V].x),q=Math.abs(g[V].y-w[F-1][V].y);(Q>q?Q:q)>2&&($=!0)}),$&&T++}}),T>=3):!1}function L(e=!1){const w=se([13,14]);if(x.value){P();return}D.value!==o.value&&(D.value=o.value,!w||e?c.value||(c.value=setInterval(()=>{if(r.value=r.value?r.value+1:1,r.value===3)p("keepMoving");else if(r.value===6)p("keepMoving");else if(r.value===9&&o.value>10){let g=5;clearInterval(v.value),v.value=setInterval(()=>{g>0?(g<=3?p(g):g===5&&p("endsoon"),g--):(p("timeOut"),clearInterval(c.value),clearInterval(v.value),x.value=!0,I.value=!1,r.value=0,c.value=void 0,ue(),P(),oe())},1e3)}},1e3)):(clearInterval(c.value),clearInterval(v.value),r.value=0,c.value=void 0))}return{num:t,time:o,countDownSrc:b,countDown:u,gameStart:I,gameEnd:x,showTip:n,startSport:te,isOutScreen:L,reStartTimer:_,reStartCountDown:h,resetSport:N,notMovingTimerInt:c,notMovingTimer:r,timer:d,rate:C,integral:E}}const Me={id:"sport-model"},Te={class:"fetch-box"},xe={src:"https://yunketang-file.dream-sports.cn/static/ready_tips_positive.png",class:"img-tips"},Be=ge({__name:"index",setup(k){const i=he(),{num:l,time:m,countDownSrc:f,countDown:y,gameStart:S,gameEnd:n,showTip:t,startSport:u,isOutScreen:b,reStartTimer:o,reStartCountDown:D,resetSport:I,rate:x,integral:d}=De(),M=v=>{if(v.length>0){let _=v[0].keypoints,h=.2,C=[0,1,5,6,11,15,12,16];if(m.value<=0&&(n.value=!0,o.value=setInterval(()=>{D.value>1?D.value-=1:(clearInterval(o.value),I())})),n.value)return;u(_,h,C)}else S.value&&!n.value&&b(!0)},B=v=>{v&&S.value&&!n.value&&b(!0),t.value=!0},r=()=>{i.back()},c=()=>{I()};return(v,_)=>{const h=fe,C=ve,E=ce,R=re;return G(),Se("div",Me,[J(h,{onUpdate:M,onError:B}),J(C,{score:s(l),"game-duration":s(m)},null,8,["score","game-duration"]),s(y)?(G(),K(E,{key:0,"start-count-down":s(f)},null,8,["start-count-down"])):W("",!0),s(n)?(G(),K(R,{key:1,modelValue:s(l),"onUpdate:modelValue":_[0]||(_[0]=O=>Ie(l)?l.value=O:null),rate:s(x),integral:s(d),reStartCountDown:s(D),onBack:r,onRestart:c},null,8,["modelValue","rate","integral","reStartCountDown"])):W("",!0),X(Z("div",Te,null,512),[[Y,!s(n)&&!s(S)||s(t)]]),X(Z("img",xe,null,512),[[Y,s(t)&&!s(n)]])])}}});const Ue=we(Be,[["__scopeId","data-v-1b37b279"]]);export{Ue as default};
