var H=(c,f,o)=>new Promise((v,d)=>{var p=a=>{try{e(o.next(a))}catch(u){d(u)}},i=a=>{try{e(o.throw(a))}catch(u){d(u)}},e=a=>a.done?v(a.value):Promise.resolve(a.value).then(p,i);e((o=o.apply(c,f)).next())});import{_ as ve}from"./h5-ai-sport.v0.0.0.GameOverDialog.d582f100.1684318478178.js";import{_ as ie,a as me}from"./h5-ai-sport.v0.0.0.GameCounter.ab805804.1684318478178.js";import{a as K,s as _e,b as fe,i as de,_ as pe}from"./h5-ai-sport.v0.0.0.utils.18f0aaca.1684318478178.js";import{m as t,o as ge,M as X,N as he,O as Se,d as Ie,c as A,e as Y,j as Z,y as n,L as ee,P as L,Q as we,R as j,S as z,v as W,z as be,b as ye,_ as ke}from"./h5-ai-sport.v0.0.0.index.95bda2e2.1684318478178.js";import{v as ae,s as te,a as $,b as xe}from"./h5-ai-sport.v0.0.0.bgAudio.2915f8b6.1684318478178.js";import{u as De}from"./h5-ai-sport.v0.0.0.Setting.214989f5.1684318478178.js";import"./h5-ai-sport.v0.0.0.index.9c59126a.1684318478178.js";const Be=(c,f,o,v,d)=>{const p=K(c[7],c[5],c[9]),i=K(c[8],c[6],c[10]);if(f.value.at(-1)===!1&&o.value){const e=p<150||i<150;v.value&&e&&(f.value.push(!0),v.value=!1,o.value=!1,d.value+=1,d.value&&ae("https://go-ran-pic.lovedabai.com/sound/Sport_Ball_appear.mp3"))}else if(f.value.at(-1)===!0&&!o.value){const e=p>170||i>170;!v.value&&e&&(o.value=!0,f.value.push(!1),v.value=!0)}};function Ce(){const c=De(),f=he(),o=60,v=["appear","tooClose","start","timeOut","comeOn","5","4","3","2","1","keepMoving","endsoon","adjustAngle"],d={};let p=[];const i=[1,2,3],e=t(!0),a=t(0),u=t(0),x=t(3),s=t(o),D=t(0),b=t(!1),C=t(!1),h=t(),y=t(),M=t(),r=t(),m=t(),k=t(),_=t(),S=t(10),T=t(0),E=t(0),R=t([!1]),O=t(!0),F=t(!0),le=t(0);ge(()=>{v.forEach(l=>{const B=l==="appear"?"Sport_Ball_appear":l;d[l]=`https://go-ran-pic.lovedabai.com/sound/${B}.mp3`})}),X(()=>{P(),te(),$()}),X(()=>{P(),te(),$()});const g=l=>{ae(d[`${l}`])},ne=(l,B,I)=>{p=_e(l),fe(l,B,I)&&de(I)&&(!b.value&&!h.value?(u.value=3,x.value=i.at(-1),oe()):u.value||(e.value=!1,Be(l,R,O,F,a),J()))},oe=()=>{let l=3;e.value=!1,clearInterval(y.value),y.value=setInterval(()=>H(this,null,function*(){l>0?(yield g(l),yield l--):(g("start"),clearInterval(y.value),c.bgMusic&&xe("https://yunketang-file.dream-sports.cn/sound/sport_background_music_03.mp3"))}),1e3),h.value=setInterval(()=>{u.value>0?(u.value--,x.value=i[u.value===2?1:0]):(clearInterval(h.value),h.value=void 0,u.value=0,b.value=!0,se())},1e3)},se=()=>{M.value=setInterval(()=>{s.value>0?(s.value===21&&g("comeOn"),s.value--,s.value==0?g("timeOut"):s.value<=5&&g(s.value)):(clearInterval(M.value),N())},1e3)},ue=()=>{_.value=setInterval(()=>{S.value>1?S.value-=1:(clearInterval(_.value),P())},1e3)},N=()=>{clearInterval(y.value),clearInterval(h.value),clearInterval(M.value),clearInterval(r.value),clearInterval(m.value),clearInterval(k.value),clearInterval(_.value),y.value=void 0,h.value=void 0,M.value=void 0,r.value=0,m.value=void 0,k.value=void 0,_.value=void 0};function P(){p=[],e.value=!0,a.value=0,s.value=o,u.value=0,x.value=3,D.value=0,b.value=!1,C.value=!1,S.value=10,R.value=[!1],O.value=!0,F.value=!0,N(),$()}const re=()=>{a.value>=1&&Se({code:f.name,score:a.value>0?a.value-1:0,time:o-s.value,photos:[]}).then(l=>{T.value=l.result.exceedRate?Number((l.result.exceedRate*100).toFixed(2)):0,E.value=l.result.integral})};function ce(l){if(a.value===0)return!0;let B=0;const I=p.slice(-5);return I.length===5?(I.forEach((w,G)=>{if(G!==0){let Q=!1;l.forEach(V=>{const U=Math.abs(w[V].x-I[G-1][V].x),q=Math.abs(w[V].y-I[G-1][V].y);(U>q?U:q)>2&&(Q=!0)}),Q&&B++}}),B>=3):!1}function J(l=!1){const I=ce([13,14]);if(C.value){N();return}D.value!==s.value&&(D.value=s.value,!I||l?m.value||(m.value=setInterval(()=>{if(r.value=r.value?r.value+1:1,r.value===3)g("keepMoving");else if(r.value===6)g("keepMoving");else if(r.value===9&&s.value>10){let w=5;clearInterval(k.value),k.value=setInterval(()=>{w>0?(w<=3?g(w):w===5&&g("endsoon"),w--):(g("timeOut"),clearInterval(m.value),clearInterval(k.value),C.value=!0,b.value=!1,r.value=0,m.value=void 0,re(),N(),ue())},1e3)}},1e3)):(clearInterval(m.value),clearInterval(k.value),r.value=0,m.value=void 0))}return{num:a,time:s,countDownSrc:x,countDown:u,gameStart:b,gameEnd:C,showTip:e,startSport:ne,isOutScreen:J,reStartTimer:_,reStartCountDown:S,resetSport:P,notMovingTimerInt:m,notMovingTimer:r,timer:h,rate:T,integral:E,shoulder_elbow_mid_line:le}}const Me={id:"sport-model"},Te={class:"fetch-box"},Ee={src:"https://yunketang-file.dream-sports.cn/static/FWC_tips.png",class:"img-tips"},Re={src:"https://yunketang-file.dream-sports.cn/static/FWC_tips_pose.png",class:"img-tips-img-pose"},Oe=Ie({__name:"index",setup(c){const f=ye(),{num:o,time:v,countDownSrc:d,countDown:p,gameStart:i,gameEnd:e,showTip:a,startSport:u,isOutScreen:x,reStartTimer:s,reStartCountDown:D,resetSport:b,rate:C,integral:h,shoulder_elbow_mid_line:y}=Ce(),M=_=>{if(_.length>0){let S=_[0].keypoints,T=.2,E=[0,1,5,6,11,15,12,16];if(v.value<=0&&(e.value=!0,s.value=setInterval(()=>{D.value>1?D.value-=1:(clearInterval(s.value),b())})),e.value)return;u(S,T,E)}else i.value&&!e.value&&x(!0)},r=_=>{_&&i.value&&!e.value&&x(!0),a.value=!0},m=()=>{f.back()},k=()=>{b()};return(_,S)=>{const T=pe,E=ie,R=me,O=ve;return A(),Y("div",Me,[Z(T,{onUpdate:M,onError:r}),Z(E,{score:n(o),"game-duration":n(v)},null,8,["score","game-duration"]),n(p)?(A(),ee(R,{key:0,"start-count-down":n(d)},null,8,["start-count-down"])):L("",!0),n(e)?(A(),ee(O,{key:1,modelValue:n(o),"onUpdate:modelValue":S[0]||(S[0]=F=>we(o)?o.value=F:null),rate:n(C),integral:n(h),reStartCountDown:n(D),onBack:m,onRestart:k},null,8,["modelValue","rate","integral","reStartCountDown"])):L("",!0),j(W("div",Te,null,512),[[z,!n(e)&&!n(i)||n(a)]]),n(y)&&!n(a)&&!n(e)?(A(),Y("div",{key:2,class:"shoulder_elbow_mid_line",style:be("top:"+n(y)+"px !important")},null,4)):L("",!0),j(W("img",Ee,null,512),[[z,n(a)&&!n(e)]]),j(W("img",Re,null,512),[[z,n(a)&&!n(e)]])])}}});const We=ke(Oe,[["__scopeId","data-v-1917f35e"]]);export{We as default};
