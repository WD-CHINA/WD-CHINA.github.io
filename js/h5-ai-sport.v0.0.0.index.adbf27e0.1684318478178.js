var L=(r,p,n)=>new Promise((d,i)=>{var x=e=>{try{t(n.next(e))}catch(u){i(u)}},c=e=>{try{t(n.throw(e))}catch(u){i(u)}},t=e=>e.done?d(e.value):Promise.resolve(e.value).then(x,c);t((n=n.apply(r,p)).next())});import{_ as Y}from"./h5-ai-sport.v0.0.0.GameOverDialog.d582f100.1684318478178.js";import{_ as Z,a as A}from"./h5-ai-sport.v0.0.0.GameCounter.ab805804.1684318478178.js";import{s as ee,c as ae,_ as te}from"./h5-ai-sport.v0.0.0.utils.18f0aaca.1684318478178.js";import{m as a,o as le,M as oe,N as ne,O as ue,d as se,c as N,e as re,j as P,y as s,L as F,P as G,Q as ve,R as U,S as j,v as $,b as ce,_ as ie}from"./h5-ai-sport.v0.0.0.index.95bda2e2.1684318478178.js";import{v as q,s as me,a as Q,b as fe}from"./h5-ai-sport.v0.0.0.bgAudio.2915f8b6.1684318478178.js";import{u as pe}from"./h5-ai-sport.v0.0.0.Setting.214989f5.1684318478178.js";import"./h5-ai-sport.v0.0.0.index.9c59126a.1684318478178.js";const _e=(r,p,n,d,i)=>{const x=r[11].y,c=r[12].y,t=r[15].y,e=r[16].y,u=Math.abs(c-e),l=Math.abs(x-t),g=u/l<.6&&Math.abs(r[11].x-r[15].x)/l<.3||l/u<.6&&Math.abs(r[12].x-r[16].x)/u<.3;p.value.at(-1)===!1?g&&n.value&&(i.value=setInterval(()=>{d.value+=1,d.value&&q("https://go-ran-pic.lovedabai.com/sound/Sport_Ball_appear.mp3")},1e3),p.value.push(!0),n.value=!1):p.value.at(-1)===!0&&!g&&!n.value&&(clearInterval(i.value),i.value=void 0,p.value.push(!1),n.value=!0)};function de(){const r=pe(),p=ne(),n=60,d=["appear","tooClose","start","timeOut","comeOn","5","4","3","2","1","keepMoving","endsoon","adjustAngle"],i={},x=[1,2,3],c=a(!0),t=a(0),e=a(0),u=a(3),l=a(n),g=a(0),I=a(!1),D=a(!1),S=a(),M=a(),T=a(),v=a(),m=a(),b=a(),f=a(),h=a(10),R=a([!1]),B=a(!0),k=a(),y=a(0),C=a(0);le(()=>{d.forEach(o=>{const w=o==="appear"?"Sport_Ball_appear":o;i[o]=`https://go-ran-pic.lovedabai.com/sound/${w}.mp3`})}),oe(()=>{E(),me(),Q()});const _=o=>{q(i[`${o}`])},z=(o,w,X)=>{ee(o),ae(o,w,X)&&(!I.value&&!S.value?(e.value=3,u.value=x.at(-1),J()):e.value||(c.value=!1,_e(o,R,B,t,k),V()))},H=()=>{t.value>=1&&ue({code:p.name,score:t.value>0?t.value-1:0,time:n-l.value,photos:[]}).then(o=>{y.value=o.result.exceedRate?Number((o.result.exceedRate*100).toFixed(2)):0,C.value=o.result.integral})},J=()=>{let o=3;c.value=!1,clearInterval(M.value),M.value=setInterval(()=>L(this,null,function*(){o>0?(yield _(o),yield o--):(_("start"),clearInterval(M.value),r.bgMusic&&fe("https://yunketang-file.dream-sports.cn/sound/sport_background_music_03.mp3"))}),1e3),S.value=setInterval(()=>{e.value>0?(e.value--,u.value=x[e.value===2?1:0]):(clearInterval(S.value),S.value=void 0,e.value=0,I.value=!0,K())},1e3)},K=()=>{T.value=setInterval(()=>{l.value>0?(l.value===21&&_("comeOn"),l.value--,l.value==0?_("timeOut"):l.value<=5&&_(l.value)):(clearInterval(T.value),O())},1e3)},W=()=>{f.value=setInterval(()=>{h.value>1?h.value-=1:(clearInterval(f.value),E())},1e3)},O=()=>{clearInterval(M.value),clearInterval(S.value),clearInterval(T.value),clearInterval(v.value),clearInterval(m.value),clearInterval(b.value),clearInterval(f.value),M.value=void 0,S.value=void 0,T.value=void 0,v.value=0,m.value=void 0,b.value=void 0,f.value=void 0,clearInterval(k.value),k.value=void 0};function E(){c.value=!0,t.value=0,l.value=n,e.value=0,u.value=3,g.value=0,I.value=!1,D.value=!1,h.value=10,R.value=[!1],B.value=!0,O(),Q()}function V(o=!1){if(D.value){O();return}g.value!==l.value&&(g.value=l.value,o?m.value||(m.value=setInterval(()=>{if(v.value=v.value?v.value+1:1,v.value===3)_("keepMoving");else if(v.value===6)_("keepMoving");else if(v.value===9&&l.value>10){let w=5;clearInterval(b.value),b.value=setInterval(()=>{w>0?(w<=3?_(w):w===5&&_("endsoon"),w--):(_("timeOut"),clearInterval(m.value),clearInterval(b.value),D.value=!0,I.value=!1,v.value=0,m.value=void 0,H(),O(),W())},1e3)}},1e3)):(clearInterval(m.value),clearInterval(b.value),v.value=0,m.value=void 0))}return{num:t,time:l,countDownSrc:u,countDown:e,gameStart:I,gameEnd:D,showTip:c,startSport:z,isOutScreen:V,reStartTimer:f,reStartCountDown:h,resetSport:E,notMovingTimerInt:m,notMovingTimer:v,timer:S,rate:y,integral:C}}const ge={id:"sport-model"},Ie={class:"fetch-box"},Se={src:"https://yunketang-file.dream-sports.cn/static/ready_tips_positive.png",class:"img-tips"},he=se({__name:"index",setup(r){const p=ce(),{num:n,time:d,countDownSrc:i,countDown:x,gameStart:c,gameEnd:t,showTip:e,startSport:u,isOutScreen:l,reStartTimer:g,reStartCountDown:I,resetSport:D,rate:S,integral:M}=de(),T=f=>{if(f.length>0){let h=f[0].keypoints,R=.2,B=[0,1,5,6,11,15,12,16];if(d.value<=0&&(t.value=!0,g.value=setInterval(()=>{I.value>1?I.value-=1:(clearInterval(g.value),D())})),t.value)return;u(h,R,B)}else c.value&&!t.value&&l(!0)},v=f=>{f&&c.value&&!t.value&&l(!0),e.value=!0},m=()=>{p.back()},b=()=>{D()};return(f,h)=>{const R=te,B=Z,k=A,y=Y;return N(),re("div",ge,[P(R,{onUpdate:T,onError:v}),P(B,{score:s(n),"game-duration":s(d)},null,8,["score","game-duration"]),s(x)?(N(),F(k,{key:0,"start-count-down":s(i)},null,8,["start-count-down"])):G("",!0),s(t)?(N(),F(y,{key:1,modelValue:s(n),"onUpdate:modelValue":h[0]||(h[0]=C=>ve(n)?n.value=C:null),rate:s(S),integral:s(M),reStartCountDown:s(I),onBack:m,onRestart:b},null,8,["modelValue","rate","integral","reStartCountDown"])):G("",!0),U($("div",Ie,null,512),[[j,!s(t)&&!s(c)||s(e)]]),U($("img",Se,null,512),[[j,s(e)&&!s(t)]])])}}});const ye=ie(he,[["__scopeId","data-v-f6f08ae0"]]);export{ye as default};
