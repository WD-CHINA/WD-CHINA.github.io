var H=(m,d,l)=>new Promise((f,v)=>{var _=t=>{try{o(l.next(t))}catch(u){v(u)}},c=t=>{try{o(l.throw(t))}catch(u){v(u)}},o=t=>t.done?f(t.value):Promise.resolve(t.value).then(_,c);o((l=l.apply(m,d)).next())});import{_ as se}from"./h5-ai-sport.v0.0.0.GameOverDialog.c9df0113.1684379857111.js";import{_ as re,a as ve}from"./h5-ai-sport.v0.0.0.GameCounter.7a2beafd.1684379857111.js";import{s as ce,c as ie,_ as me}from"./h5-ai-sport.v0.0.0.utils.de482c22.1684379857111.js";import{m as a,o as fe,M as J,N as _e,O as pe,d as de,c as G,e as ge,j as K,y as s,L as W,P as X,Q as Se,R as Y,S as Z,v as A,b as he,_ as Ie}from"./h5-ai-sport.v0.0.0.index.a6c8dc0f.1684379857111.js";import{v as j,s as ee,a as U,b as we}from"./h5-ai-sport.v0.0.0.bgAudio.47f05ebc.1684379857111.js";import{u as ye}from"./h5-ai-sport.v0.0.0.Setting.b13cabb0.1684379857111.js";import"./h5-ai-sport.v0.0.0.index.92382d81.1684379857111.js";const be=(m,d,l,f,v)=>{const _=m[13].y,c=m[14].y;d.value.at(-1)===!1&&l.value?c/_>1.2&&c>(m[11].y+m[12].y)/2*1.2&&f.value&&(v.value+=1,d.value.push(!0),f.value=!1,l.value=!1,v.value&&j("https://go-ran-pic.lovedabai.com/sound/Sport_Ball_appear.mp3")):d.value.at(-1)===!0&&!l.value&&_/c>1.2&&_>(m[11].y+m[12].y)/2*1.2&&(f.value||(v.value+=1,d.value.push(!1),f.value=!0,l.value=!0,v.value&&j("https://go-ran-pic.lovedabai.com/sound/Sport_Ball_appear.mp3")))};function ke(){const m=ye(),d=_e(),l=60,f=["appear","tooClose","start","timeOut","comeOn","5","4","3","2","1","keepMoving","endsoon","adjustAngle"],v={};let _=[];const c=[1,2,3],o=a(!0),t=a(0),u=a(0),k=a(3),n=a(l),D=a(0),w=a(!1),T=a(!1),h=a(),B=a(),x=a(),r=a(),p=a(),i=a(),g=a(),y=a(10),C=a(0),E=a(0),O=a([!1]),R=a(!0),L=a(!0);fe(()=>{f.forEach(e=>{const M=e==="appear"?"Sport_Ball_appear":e;v[e]=`https://go-ran-pic.lovedabai.com/sound/${M}.mp3`})}),J(()=>{N(),ee(),U()}),J(()=>{N(),ee(),U()});const S=e=>{j(v[`${e}`])},ae=(e,M,b)=>{_=ce(e),ie(e,M,b)&&(!w.value&&!h.value?(u.value=3,k.value=c.at(-1),te()):u.value||(o.value=!1,be(e,O,R,L,t),$()))},te=()=>{let e=3;o.value=!1,clearInterval(B.value),B.value=setInterval(()=>H(this,null,function*(){e>0?(yield S(e),yield e--):(S("start"),clearInterval(B.value),m.bgMusic&&we("https://yunketang-file.dream-sports.cn/sound/sport_background_music_03.mp3"))}),1e3),h.value=setInterval(()=>{u.value>0?(u.value--,k.value=c[u.value===2?1:0]):(clearInterval(h.value),h.value=void 0,u.value=0,w.value=!0,le())},1e3)},le=()=>{x.value=setInterval(()=>{n.value>0?(n.value===21&&S("comeOn"),n.value--,n.value==0?S("timeOut"):n.value<=5&&S(n.value)):(clearInterval(x.value),P())},1e3)},oe=()=>{g.value=setInterval(()=>{y.value>1?y.value-=1:(clearInterval(g.value),N())},1e3)},P=()=>{clearInterval(B.value),clearInterval(h.value),clearInterval(x.value),clearInterval(r.value),clearInterval(p.value),clearInterval(i.value),clearInterval(g.value),B.value=void 0,h.value=void 0,x.value=void 0,r.value=0,p.value=void 0,i.value=void 0,g.value=void 0};function N(){_=[],o.value=!0,t.value=0,n.value=l,u.value=0,k.value=3,D.value=0,w.value=!1,T.value=!1,y.value=10,O.value=[!1],R.value=!0,L.value=!0,P(),U()}const ne=()=>{t.value>=1&&pe({code:d.name,score:t.value>0?t.value-1:0,time:l-n.value,photos:[]}).then(e=>{C.value=e.result.exceedRate?Number((e.result.exceedRate*100).toFixed(2)):0,E.value=e.result.integral})};function ue(e){if(t.value===0)return!0;let M=0;const b=_.slice(-5);return b.length===5?(b.forEach((I,F)=>{if(F!==0){let Q=!1;e.forEach(V=>{const q=Math.abs(I[V].x-b[F-1][V].x),z=Math.abs(I[V].y-b[F-1][V].y);(q>z?q:z)>2&&(Q=!0)}),Q&&M++}}),M>=3):!1}function $(e=!1){const b=ue([13,14]);if(T.value){P();return}D.value!==n.value&&(D.value=n.value,!b||e?p.value||(p.value=setInterval(()=>{if(r.value=r.value?r.value+1:1,r.value===3)S("keepMoving");else if(r.value===6)S("keepMoving");else if(r.value===9&&n.value>10){let I=5;clearInterval(i.value),i.value=setInterval(()=>{I>0?(I<=3?S(I):I===5&&S("endsoon"),I--):(S("timeOut"),clearInterval(p.value),clearInterval(i.value),T.value=!0,w.value=!1,r.value=0,p.value=void 0,ne(),P(),oe())},1e3)}},1e3)):(clearInterval(p.value),clearInterval(i.value),r.value=0,p.value=void 0))}return{num:t,time:n,countDownSrc:k,countDown:u,gameStart:w,gameEnd:T,showTip:o,startSport:ae,isOutScreen:$,reStartTimer:g,reStartCountDown:y,resetSport:N,notMovingTimerInt:p,notMovingTimer:r,timer:h,rate:C,integral:E}}const De={id:"sport-model"},Be={class:"fetch-box"},Me={src:"https://yunketang-file.dream-sports.cn/static/ready_tips_positive.png",class:"img-tips"},Te=de({__name:"index",setup(m){const d=he(),{num:l,time:f,countDownSrc:v,countDown:_,gameStart:c,gameEnd:o,showTip:t,startSport:u,isOutScreen:k,reStartTimer:n,reStartCountDown:D,resetSport:w,rate:T,integral:h}=ke(),B=i=>{if(i.length>0){let g=i[0].keypoints,y=.2,C=[0,1,5,6,11,15,12,16];if(f.value<=0&&(o.value=!0,n.value=setInterval(()=>{D.value>1?D.value-=1:(clearInterval(n.value),w())})),o.value)return;u(g,y,C)}else c.value&&!o.value&&k(!0)},x=i=>{i&&c.value&&!o.value&&k(!0),t.value=!0},r=()=>{d.back()},p=()=>{w()};return(i,g)=>{const y=me,C=re,E=ve,O=se;return G(),ge("div",De,[K(y,{onUpdate:B,onError:x}),K(C,{score:s(l),"game-duration":s(f)},null,8,["score","game-duration"]),s(_)?(G(),W(E,{key:0,"start-count-down":s(v)},null,8,["start-count-down"])):X("",!0),s(o)?(G(),W(O,{key:1,modelValue:s(l),"onUpdate:modelValue":g[0]||(g[0]=R=>Se(l)?l.value=R:null),rate:s(T),integral:s(h),reStartCountDown:s(D),onBack:r,onRestart:p},null,8,["modelValue","rate","integral","reStartCountDown"])):X("",!0),Y(A("div",Be,null,512),[[Z,!s(o)&&!s(c)||s(t)]]),Y(A("img",Me,null,512),[[Z,s(t)&&!s(o)]])])}}});const Ge=Ie(Te,[["__scopeId","data-v-050001db"]]);export{Ge as default};
