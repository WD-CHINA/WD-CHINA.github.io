var Q=(r,_,l)=>new Promise((i,d)=>{var p=e=>{try{o(l.next(e))}catch(u){d(u)}},m=e=>{try{o(l.throw(e))}catch(u){d(u)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(p,m);o((l=l.apply(r,_)).next())});import{_ as ne}from"./h5-ai-sport.v0.0.0.GameOverDialog.6627159e.1684379358906.js";import{_ as ue,a as se}from"./h5-ai-sport.v0.0.0.GameCounter.37fff7f2.1684379358906.js";import{s as re,c as ve,_ as ce}from"./h5-ai-sport.v0.0.0.utils.818e0269.1684379358906.js";import{m as t,o as ie,M as me,N as fe,O as _e,d as de,c as G,e as pe,j as q,y as s,L as z,P as H,Q as ge,R as J,S as K,v as W,b as Se,_ as he}from"./h5-ai-sport.v0.0.0.index.eb36d521.1684379358906.js";import{v as Z,s as Ie,a as X,b as we}from"./h5-ai-sport.v0.0.0.bgAudio.9e45de03.1684379358906.js";import{u as ye}from"./h5-ai-sport.v0.0.0.Setting.35b97f7f.1684379358906.js";import"./h5-ai-sport.v0.0.0.index.1a7b6993.1684379358906.js";const Me=(r,_,l,i,d)=>{const p=Math.abs((r[11].y+r[12].y)/2-(r[15].y+r[16].y)/2),m=Math.abs((r[14].y+r[13].y)/2-(r[16].y+r[15].y)/2),o=p/m>1.5,e=p/m<.9;_.value.at(-1)===!1&&l.value?i.value&&o&&(_.value.push(!0),i.value=!1,l.value=!1):_.value.at(-1)===!0&&!l.value&&!i.value&&e&&(d.value+=1,d.value&&Z("https://go-ran-pic.lovedabai.com/sound/Sport_Ball_appear.mp3"),_.value.push(!1),i.value=!0,l.value=!0)};function Te(){const r=ye(),_=fe(),l=60,i=["appear","tooClose","start","timeOut","comeOn","5","4","3","2","1","keepMoving","endsoon","adjustAngle"],d={};let p=[];const m=[1,2,3],o=t(!0),e=t(0),u=t(0),T=t(3),n=t(l),b=t(0),w=t(!1),x=t(!1),h=t(),D=t(),B=t(),v=t(),f=t(),c=t(),g=t(),y=t(10),C=t([!1]),E=t(!0),O=t(!0),R=t(0),U=t(0);ie(()=>{i.forEach(a=>{const k=a==="appear"?"Sport_Ball_appear":a;d[a]=`https://go-ran-pic.lovedabai.com/sound/${k}.mp3`})}),me(()=>{V(),Ie(),X()});const S=a=>{Z(d[`${a}`])},A=(a,k,M)=>{p=re(a),ve(a,k,M)&&(!w.value&&!h.value?(u.value=3,T.value=m.at(-1),ae()):u.value||(o.value=!1,Me(a,C,E,O,e),j()))},ee=()=>{e.value>=1&&_e({code:_.name,score:e.value>0?e.value-1:0,time:l-n.value,photos:[]}).then(a=>{R.value=a.result.exceedRate?Number((a.result.exceedRate*100).toFixed(2)):0,U.value=a.result.integral})},ae=()=>{let a=3;o.value=!1,clearInterval(D.value),D.value=setInterval(()=>Q(this,null,function*(){a>0?(yield S(a),yield a--):(S("start"),clearInterval(D.value),r.bgMusic&&we("https://yunketang-file.dream-sports.cn/sound/sport_background_music_03.mp3"))}),1e3),h.value=setInterval(()=>{u.value>0?(u.value--,T.value=m[u.value===2?1:0]):(clearInterval(h.value),h.value=void 0,u.value=0,w.value=!0,te())},1e3)},te=()=>{B.value=setInterval(()=>{n.value>0?(n.value===21&&S("comeOn"),n.value--,n.value==0?S("timeOut"):n.value<=5&&S(n.value)):(clearInterval(B.value),P())},1e3)},le=()=>{g.value=setInterval(()=>{y.value>1?y.value-=1:(clearInterval(g.value),V())},1e3)},P=()=>{clearInterval(D.value),clearInterval(h.value),clearInterval(B.value),clearInterval(v.value),clearInterval(f.value),clearInterval(c.value),clearInterval(g.value),D.value=void 0,h.value=void 0,B.value=void 0,v.value=0,f.value=void 0,c.value=void 0,g.value=void 0};function V(){p=[],o.value=!0,e.value=0,n.value=l,u.value=0,T.value=3,b.value=0,w.value=!1,x.value=!1,y.value=10,C.value=[!1],E.value=!0,O.value=!0,P(),X()}function oe(a){if(e.value===0)return!0;let k=0;const M=p.slice(-5);return M.length===5?(M.forEach((I,F)=>{if(F!==0){let L=!1;a.forEach(N=>{const Y=Math.abs(I[N].x-M[F-1][N].x),$=Math.abs(I[N].y-M[F-1][N].y);(Y>$?Y:$)>2&&(L=!0)}),L&&k++}}),k>=3):!1}function j(a=!1){const M=oe([13,14]);if(x.value){P();return}b.value!==n.value&&(b.value=n.value,!M||a?f.value||(f.value=setInterval(()=>{if(v.value=v.value?v.value+1:1,v.value===3)S("keepMoving");else if(v.value===6)S("keepMoving");else if(v.value===9&&n.value>10){let I=5;clearInterval(c.value),c.value=setInterval(()=>{I>0?(I<=3?S(I):I===5&&S("endsoon"),I--):(S("timeOut"),clearInterval(f.value),clearInterval(c.value),x.value=!0,w.value=!1,v.value=0,f.value=void 0,ee(),P(),le())},1e3)}},1e3)):(clearInterval(f.value),clearInterval(c.value),v.value=0,f.value=void 0))}return{num:e,time:n,countDownSrc:T,countDown:u,gameStart:w,gameEnd:x,showTip:o,startSport:A,isOutScreen:j,reStartTimer:g,reStartCountDown:y,resetSport:V,notMovingTimerInt:f,notMovingTimer:v,timer:h,rate:R,integral:U}}const be={id:"sport-model"},De={class:"fetch-box"},ke={src:"https://yunketang-file.dream-sports.cn/static/ready_tips_positive.png",class:"img-tips"},xe=de({__name:"index",setup(r){const _=Se(),{num:l,time:i,countDownSrc:d,countDown:p,gameStart:m,gameEnd:o,showTip:e,startSport:u,isOutScreen:T,reStartTimer:n,reStartCountDown:b,resetSport:w,rate:x,integral:h}=Te(),D=c=>{if(c.length>0){let g=c[0].keypoints,y=.2,C=[0,1,5,6,11,15,12,16];if(i.value<=0&&(o.value=!0,n.value=setInterval(()=>{b.value>1?b.value-=1:(clearInterval(n.value),w())})),o.value)return;u(g,y,C)}else m.value&&!o.value&&T(!0)},B=c=>{c&&m.value&&!o.value&&T(!0),e.value=!0},v=()=>{_.back()},f=()=>{w()};return(c,g)=>{const y=ce,C=ue,E=se,O=ne;return G(),pe("div",be,[q(y,{onUpdate:D,onError:B}),q(C,{score:s(l),"game-duration":s(i)},null,8,["score","game-duration"]),s(p)?(G(),z(E,{key:0,"start-count-down":s(d)},null,8,["start-count-down"])):H("",!0),s(o)?(G(),z(O,{key:1,modelValue:s(l),"onUpdate:modelValue":g[0]||(g[0]=R=>ge(l)?l.value=R:null),rate:s(x),integral:s(h),reStartCountDown:s(b),onBack:v,onRestart:f},null,8,["modelValue","rate","integral","reStartCountDown"])):H("",!0),J(W("div",De,null,512),[[K,!s(o)&&!s(m)||s(e)]]),J(W("img",ke,null,512),[[K,s(e)&&!s(o)]])])}}});const Ge=he(xe,[["__scopeId","data-v-3a8921a3"]]);export{Ge as default};
