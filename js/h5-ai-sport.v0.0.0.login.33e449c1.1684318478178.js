var P=(e,a,r)=>new Promise((o,i)=>{var c=u=>{try{s(r.next(u))}catch(f){i(f)}},d=u=>{try{s(r.throw(u))}catch(f){i(f)}},s=u=>u.done?o(u.value):Promise.resolve(u.value).then(c,d);s((r=r.apply(e,a)).next())});import{f as U,d as M,h as q,i as j,j as T,n as z,t as R,p as G,F as H,w as K,k as X,l as F,r as J,b as Y,u as Q,m as k,q as Z,c as ee,e as te,v as S,x as C,y as w,z as ne,A as ae,B as D,C as re,D as ie,E as oe,G as se,H as V,I as le,J as ue,K as ce,_ as de}from"./h5-ai-sport.v0.0.0.index.95bda2e2.1684318478178.js";import{C as fe}from"./h5-ai-sport.v0.0.0.index.d5370f6e.1684318478178.js";import"./h5-ai-sport.v0.0.0.index.250d1fd0.1684318478178.js";import{F as me}from"./h5-ai-sport.v0.0.0.index.dd2c3934.1684318478178.js";import"./h5-ai-sport.v0.0.0.use-id.63b167f5.1684318478178.js";const[ve,pe]=U("form"),ge={colon:Boolean,disabled:Boolean,readonly:Boolean,showError:Boolean,labelWidth:z,labelAlign:String,inputAlign:String,scrollToError:Boolean,validateFirst:Boolean,submitOnEnter:R,showErrorMessage:R,errorMessageAlign:String,validateTrigger:{type:[String,Array],default:"onBlur"}};var _e=M({name:ve,props:ge,emits:["submit","failed"],setup(e,{emit:a,slots:r}){const{children:o,linkChildren:i}=q(H),c=t=>t?o.filter(n=>t.includes(n.name)):o,d=t=>new Promise((n,m)=>{const h=[];c(t).reduce((I,l)=>I.then(()=>{if(!h.length)return l.validate().then(_=>{_&&h.push(_)})}),Promise.resolve()).then(()=>{h.length?m(h):n()})}),s=t=>new Promise((n,m)=>{const h=c(t);Promise.all(h.map(g=>g.validate())).then(g=>{g=g.filter(Boolean),g.length?m(g):n()})}),u=t=>{const n=o.find(m=>m.name===t);return n?new Promise((m,h)=>{n.validate().then(g=>{g?h(g):m()})}):Promise.reject()},f=t=>typeof t=="string"?u(t):e.validateFirst?d(t):s(t),y=t=>{typeof t=="string"&&(t=[t]),c(t).forEach(m=>{m.resetValidation()})},p=()=>o.reduce((t,n)=>(t[n.name]=n.getValidationStatus(),t),{}),v=(t,n)=>{o.some(m=>m.name===t?(m.$el.scrollIntoView(n),!0):!1)},b=()=>o.reduce((t,n)=>(n.name!==void 0&&(t[n.name]=n.formValue.value),t),{}),x=()=>{const t=b();f().then(()=>a("submit",t)).catch(n=>{a("failed",{values:t,errors:n}),e.scrollToError&&n[0].name&&v(n[0].name)})},E=t=>{G(t),x()};return i({props:e}),j({submit:x,validate:f,getValues:b,scrollToField:v,resetValidation:y,getValidationStatus:p}),()=>{var t;return T("form",{class:pe(),onSubmit:E},[(t=r.default)==null?void 0:t.call(r)])}}});const he=K(_e);var be=/\s/;function ye(e){for(var a=e.length;a--&&be.test(e.charAt(a)););return a}var xe=/^\s+/;function Te(e){return e&&e.slice(0,ye(e)+1).replace(xe,"")}var O=0/0,Se=/^[-+]0x[0-9a-f]+$/i,Ee=/^0b[01]+$/i,Ie=/^0o[0-7]+$/i,Be=parseInt;function W(e){if(typeof e=="number")return e;if(X(e))return O;if(F(e)){var a=typeof e.valueOf=="function"?e.valueOf():e;e=F(a)?a+"":a}if(typeof e!="string")return e===0?e:+e;e=Te(e);var r=Ee.test(e);return r||Ie.test(e)?Be(e.slice(2),r?2:8):Se.test(e)?O:+e}var Ve=function(){return J.Date.now()};const A=Ve;var ke="Expected a function",Ce=Math.max,we=Math.min;function Fe(e,a,r){var o,i,c,d,s,u,f=0,y=!1,p=!1,v=!0;if(typeof e!="function")throw new TypeError(ke);a=W(a)||0,F(r)&&(y=!!r.leading,p="maxWait"in r,c=p?Ce(W(r.maxWait)||0,a):c,v="trailing"in r?!!r.trailing:v);function b(l){var _=o,B=i;return o=i=void 0,f=l,d=e.apply(B,_),d}function x(l){return f=l,s=setTimeout(n,a),y?b(l):d}function E(l){var _=l-u,B=l-f,N=a-_;return p?we(N,c-B):N}function t(l){var _=l-u,B=l-f;return u===void 0||_>=a||_<0||p&&B>=c}function n(){var l=A();if(t(l))return m(l);s=setTimeout(n,E(l))}function m(l){return s=void 0,v&&o?b(l):(o=i=void 0,d)}function h(){s!==void 0&&clearTimeout(s),f=0,o=u=i=s=void 0}function g(){return s===void 0?d:m(A())}function I(){var l=A(),_=t(l);if(o=arguments,i=this,u=l,_){if(s===void 0)return x(u);if(p)return clearTimeout(s),s=setTimeout(n,a),b(u)}return s===void 0&&(s=setTimeout(n,a)),d}return I.cancel=h,I.flush=g,I}var Pe="Expected a function";function $(e,a,r){var o=!0,i=!0;if(typeof e!="function")throw new TypeError(Pe);return F(r)&&(o="leading"in r?!!r.leading:o,i="trailing"in r?!!r.trailing:i),Fe(e,a,{leading:o,maxWait:a,trailing:i})}const L=e=>(oe("data-v-97caf37f"),e=e(),se(),e),Ae={class:"codeLogin"},Ne=L(()=>S("div",{class:"codeTitle"},"你好，请登录",-1)),Re={style:{margin:"100px 16px"}},Oe=L(()=>S("div",{class:"xieyi"},[D(" 点击确定即同意 "),S("a",{href:"https://yunketang-file.dream-sports.cn/protocol/app-user-agreement.html"},"《用户注册协议》")],-1)),We=M({__name:"login",setup(e){const a=/^(?:(?:\+|00)86)?1[3-9]\d{9}$/,r=Y(),o=Q(),i=k(""),c=k(""),d=k(60),s=k("获取验证码"),u=Z(()=>!a.test(i.value)||c.value.length===0),f=$(()=>{if(!a.test(i.value))return V("手机号码不正确");le({mobile:i.value,function:"bind"}).then(()=>{V("验证码已发送");let p=setInterval(()=>{--d.value,s.value=`倒计时${d.value}秒`,d.value===0&&(clearInterval(p),s.value="获取验证码")},1e3)}).catch(()=>{V("发送失败")})},3e3),y=$(()=>{if(!a.test(i.value))return V("手机号码不正确");ue({type:"mobile",code:c.value,mobile:i.value}).then(p=>P(this,null,function*(){V("登录成功"),o.setToken(p.result.token),o.setUserInfo().then(()=>P(this,null,function*(){yield ce(),r.replace("/")}))}))},3e3);return(p,v)=>{const b=me,x=fe,E=ie,t=he;return ee(),te(re,null,[S("div",Ae,[Ne,T(t,{onSubmit:w(y)},{default:C(()=>[T(x,{inset:""},{default:C(()=>[T(b,{modelValue:i.value,"onUpdate:modelValue":v[0]||(v[0]=n=>i.value=n),type:"tel",name:"手机号码",placeholder:"请输入手机号码",clearable:"",rules:[{required:!0,message:"请输入手机号码"}]},null,8,["modelValue"]),T(b,{modelValue:c.value,"onUpdate:modelValue":v[2]||(v[2]=n=>c.value=n),type:"text",border:"",name:"密码",placeholder:"请输入验证码",clearable:"",rules:[{required:!0,message:"请输入验证码"}]},{button:C(()=>[S("div",{onClick:v[1]||(v[1]=(...n)=>w(f)&&w(f)(...n)),style:ne(d.value>=60&&a.test(i.value)?"color:var(--van-blue)":"color:var(--van-text-color-3)")},ae(s.value),5)]),_:1},8,["modelValue"])]),_:1}),S("div",Re,[T(E,{disabled:w(u),round:"",block:"",type:"primary","native-type":"submit"},{default:C(()=>[D(" 登录 ")]),_:1},8,["disabled"])])]),_:1},8,["onSubmit"])]),Oe],64)}}});const je=de(We,[["__scopeId","data-v-97caf37f"]]);export{je as default};
