var H=(c,d,o)=>new Promise((v,f)=>{var p=a=>{try{e(o.next(a))}catch(u){f(u)}},i=a=>{try{e(o.throw(a))}catch(u){f(u)}},e=a=>a.done?v(a.value):Promise.resolve(a.value).then(p,i);e((o=o.apply(c,d)).next())});import{_ as ve}from"./h5-ai-sport.v0.0.0.GameOverDialog.c9df0113.1684379857111.js";import{_ as ie,a as me}from"./h5-ai-sport.v0.0.0.GameCounter.7a2beafd.1684379857111.js";import{a as K,s as _e,c as de,_ as fe}from"./h5-ai-sport.v0.0.0.utils.de482c22.1684379857111.js";import{m as t,o as pe,M as X,N as ge,O as he,d as Se,c as A,e as Y,j as Z,y as n,L as ee,P as L,Q as Ie,R as j,S as z,v as W,z as we,b as be,_ as ye}from"./h5-ai-sport.v0.0.0.index.a6c8dc0f.1684379857111.js";import{v as ae,s as te,a as $,b as ke}from"./h5-ai-sport.v0.0.0.bgAudio.47f05ebc.1684379857111.js";import{u as De}from"./h5-ai-sport.v0.0.0.Setting.b13cabb0.1684379857111.js";import"./h5-ai-sport.v0.0.0.index.92382d81.1684379857111.js";const xe=(c,d,o,v,f)=>{const p=K(c[7],c[5],c[9]),i=K(c[8],c[6],c[10]);if(d.value.at(-1)===!1&&o.value){const e=p<150||i<150;v.value&&e&&(d.value.push(!0),v.value=!1,o.value=!1,f.value+=1,f.value&&ae("https://go-ran-pic.lovedabai.com/sound/Sport_Ball_appear.mp3"))}else if(d.value.at(-1)===!0&&!o.value){const e=p>170||i>170;!v.value&&e&&(o.value=!0,d.value.push(!1),v.value=!0)}};function Me(){const c=De(),d=ge(),o=60,v=["appear","tooClose","start","timeOut","comeOn","5","4","3","2","1","keepMoving","endsoon","adjustAngle"],f={};let p=[];const i=[1,2,3],e=t(!0),a=t(0),u=t(0),D=t(3),s=t(o),x=t(0),w=t(!1),T=t(!1),h=t(),b=t(),B=t(),r=t(),m=t(),y=t(),_=t(),S=t(10),C=t(0),E=t(0),R=t([!1]),O=t(!0),F=t(!0),le=t(0);pe(()=>{v.forEach(l=>{const M=l==="appear"?"Sport_Ball_appear":l;f[l]=`https://go-ran-pic.lovedabai.com/sound/${M}.mp3`})}),X(()=>{N(),te(),$()}),X(()=>{N(),te(),$()});const g=l=>{ae(f[`${l}`])},ne=(l,M,k)=>{p=_e(l),de(l,M,k)&&(!w.value&&!h.value?(u.value=3,D.value=i.at(-1),oe()):u.value||(e.value=!1,xe(l,R,O,F,a),J()))},oe=()=>{let l=3;e.value=!1,clearInterval(b.value),b.value=setInterval(()=>H(this,null,function*(){l>0?(yield g(l),yield l--):(g("start"),clearInterval(b.value),c.bgMusic&&ke("https://yunketang-file.dream-sports.cn/sound/sport_background_music_03.mp3"))}),1e3),h.value=setInterval(()=>{u.value>0?(u.value--,D.value=i[u.value===2?1:0]):(clearInterval(h.value),h.value=void 0,u.value=0,w.value=!0,se())},1e3)},se=()=>{B.value=setInterval(()=>{s.value>0?(s.value===21&&g("comeOn"),s.value--,s.value==0?g("timeOut"):s.value<=5&&g(s.value)):(clearInterval(B.value),P())},1e3)},ue=()=>{_.value=setInterval(()=>{S.value>1?S.value-=1:(clearInterval(_.value),N())},1e3)},P=()=>{clearInterval(b.value),clearInterval(h.value),clearInterval(B.value),clearInterval(r.value),clearInterval(m.value),clearInterval(y.value),clearInterval(_.value),b.value=void 0,h.value=void 0,B.value=void 0,r.value=0,m.value=void 0,y.value=void 0,_.value=void 0};function N(){p=[],e.value=!0,a.value=0,s.value=o,u.value=0,D.value=3,x.value=0,w.value=!1,T.value=!1,S.value=10,R.value=[!1],O.value=!0,F.value=!0,P(),$()}const re=()=>{a.value>=1&&he({code:d.name,score:a.value>0?a.value-1:0,time:o-s.value,photos:[]}).then(l=>{C.value=l.result.exceedRate?Number((l.result.exceedRate*100).toFixed(2)):0,E.value=l.result.integral})};function ce(l){if(a.value===0)return!0;let M=0;const k=p.slice(-5);return k.length===5?(k.forEach((I,G)=>{if(G!==0){let Q=!1;l.forEach(V=>{const U=Math.abs(I[V].x-k[G-1][V].x),q=Math.abs(I[V].y-k[G-1][V].y);(U>q?U:q)>2&&(Q=!0)}),Q&&M++}}),M>=3):!1}function J(l=!1){const k=ce([13,14]);if(T.value){P();return}x.value!==s.value&&(x.value=s.value,!k||l?m.value||(m.value=setInterval(()=>{if(r.value=r.value?r.value+1:1,r.value===3)g("keepMoving");else if(r.value===6)g("keepMoving");else if(r.value===9&&s.value>10){let I=5;clearInterval(y.value),y.value=setInterval(()=>{I>0?(I<=3?g(I):I===5&&g("endsoon"),I--):(g("timeOut"),clearInterval(m.value),clearInterval(y.value),T.value=!0,w.value=!1,r.value=0,m.value=void 0,re(),P(),ue())},1e3)}},1e3)):(clearInterval(m.value),clearInterval(y.value),r.value=0,m.value=void 0))}return{num:a,time:s,countDownSrc:D,countDown:u,gameStart:w,gameEnd:T,showTip:e,startSport:ne,isOutScreen:J,reStartTimer:_,reStartCountDown:S,resetSport:N,notMovingTimerInt:m,notMovingTimer:r,timer:h,rate:C,integral:E,shoulder_elbow_mid_line:le}}const Te={id:"sport-model"},Be={class:"fetch-box"},Ce={src:"https://yunketang-file.dream-sports.cn/static/FWC_tips.png",class:"img-tips"},Ee={src:"https://yunketang-file.dream-sports.cn/static/FWC_tips_pose.png",class:"img-tips-img-pose"},Re=Se({__name:"index",setup(c){const d=be(),{num:o,time:v,countDownSrc:f,countDown:p,gameStart:i,gameEnd:e,showTip:a,startSport:u,isOutScreen:D,reStartTimer:s,reStartCountDown:x,resetSport:w,rate:T,integral:h,shoulder_elbow_mid_line:b}=Me(),B=_=>{if(_.length>0){let S=_[0].keypoints,C=.2,E=[0,1,5,6,11,15,12,16];if(v.value<=0&&(e.value=!0,s.value=setInterval(()=>{x.value>1?x.value-=1:(clearInterval(s.value),w())})),e.value)return;u(S,C,E)}else i.value&&!e.value&&D(!0)},r=_=>{_&&i.value&&!e.value&&D(!0),a.value=!0},m=()=>{d.back()},y=()=>{w()};return(_,S)=>{const C=fe,E=ie,R=me,O=ve;return A(),Y("div",Te,[Z(C,{onUpdate:B,onError:r}),Z(E,{score:n(o),"game-duration":n(v)},null,8,["score","game-duration"]),n(p)?(A(),ee(R,{key:0,"start-count-down":n(f)},null,8,["start-count-down"])):L("",!0),n(e)?(A(),ee(O,{key:1,modelValue:n(o),"onUpdate:modelValue":S[0]||(S[0]=F=>Ie(o)?o.value=F:null),rate:n(T),integral:n(h),reStartCountDown:n(x),onBack:m,onRestart:y},null,8,["modelValue","rate","integral","reStartCountDown"])):L("",!0),j(W("div",Be,null,512),[[z,!n(e)&&!n(i)||n(a)]]),n(b)&&!n(a)&&!n(e)?(A(),Y("div",{key:2,class:"shoulder_elbow_mid_line",style:we("top:"+n(b)+"px !important")},null,4)):L("",!0),j(W("img",Ce,null,512),[[z,n(a)&&!n(e)]]),j(W("img",Ee,null,512),[[z,n(a)&&!n(e)]])])}}});const ze=ye(Re,[["__scopeId","data-v-7b840068"]]);export{ze as default};
