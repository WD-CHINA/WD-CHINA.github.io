import{f as V,al as ge,ag as E,aR as G,d as $,n as F,b0 as I,b5 as _,m as y,aI as Te,as as oe,i as le,b6 as xe,ay as ce,j as d,p as ie,b7 as X,h as se,b2 as J,ar as K,t as Oe,aj as pe,q as k,aY as Ce,aw as j,b8 as L,b9 as ke,ae as ye,ax as Z,ba as Ee}from"./h5-ai-sport.v0.0.0.index.a6c8dc0f.1684379857111.js";import{T as Se,a as we}from"./h5-ai-sport.v0.0.0.index.345ad689.1684379857111.js";const[Pe,O,ee]=V("picker"),ue=e=>e.find(o=>!o.disabled)||e[0];function Be(e,o){const n=e[0];if(n){if(Array.isArray(n))return"multiple";if(o.children in n)return"cascade"}return"default"}function Q(e,o){o=G(o,0,e.length);for(let n=o;n<e.length;n++)if(!e[n].disabled)return n;for(let n=o-1;n>=0;n--)if(!e[n].disabled)return n;return 0}const te=(e,o,n)=>o!==void 0&&!!e.find(i=>i[n.value]===o);function W(e,o,n){const i=e.findIndex(h=>h[n.value]===o),l=Q(e,i);return e[l]}function Ne(e,o,n){const i=[];let l={[o.children]:e},h=0;for(;l&&l[o.children];){const f=l[o.children],b=n.value[h];if(l=ge(b)?W(f,b,o):void 0,!l&&f.length){const u=ue(f)[o.value];l=W(f,u,o)}h++,i.push(f)}return i}function He(e){const{transform:o}=window.getComputedStyle(e),n=o.slice(7,o.length-1).split(", ")[5];return Number(n)}function Me(e){return E({text:"text",value:"value",children:"children"},e)}const ne=200,ae=300,De=15,[re,q]=V("picker-column"),de=Symbol(re);var Ie=$({name:re,props:{value:F,fields:I(Object),options:_(),readonly:Boolean,allowHtml:Boolean,optionHeight:I(Number),swipeDuration:I(F),visibleOptionNum:I(F)},emits:["change","clickOption"],setup(e,{emit:o,slots:n}){let i,l,h,f,b;const u=y(),g=y(),m=y(0),v=y(0),T=Te(),p=()=>e.options.length,w=()=>e.optionHeight*(+e.visibleOptionNum-1)/2,C=c=>{const r=Q(e.options,c),t=-r*e.optionHeight,a=()=>{const s=e.options[r][e.fields.value];s!==e.value&&o("change",s)};i&&t!==m.value?b=a:a(),m.value=t},x=()=>e.readonly||!e.options.length,A=c=>{i||x()||(b=null,v.value=ne,C(c),o("clickOption",e.options[c]))},P=c=>G(Math.round(-c/e.optionHeight),0,p()-1),B=(c,r)=>{const t=Math.abs(c/r);c=m.value+t/.003*(c<0?-1:1);const a=P(c);v.value=+e.swipeDuration,C(a)},N=()=>{i=!1,v.value=0,b&&(b(),b=null)},U=c=>{if(!x()){if(T.start(c),i){const r=He(g.value);m.value=Math.min(0,r-w())}v.value=0,l=m.value,h=Date.now(),f=l,b=null}},Y=c=>{if(x())return;T.move(c),T.isVertical()&&(i=!0,ie(c,!0)),m.value=G(l+T.deltaY.value,-(p()*e.optionHeight),e.optionHeight);const r=Date.now();r-h>ae&&(h=r,f=m.value)},H=()=>{if(x())return;const c=m.value-f,r=Date.now()-h;if(r<ae&&Math.abs(c)>De){B(c,r);return}const a=P(m.value);v.value=ne,C(a),setTimeout(()=>{i=!1},0)},M=()=>{const c={height:`${e.optionHeight}px`};return e.options.map((r,t)=>{const a=r[e.fields.text],{disabled:s}=r,D=r[e.fields.value],S={role:"button",style:c,tabindex:s?-1:0,class:[q("item",{disabled:s,selected:D===e.value}),r.className],onClick:()=>A(t)},be={class:"van-ellipsis",[e.allowHtml?"innerHTML":"textContent"]:a};return d("li",S,[n.option?n.option(r,t):d("div",be,null)])})};return oe(de),le({stopMomentum:N}),xe(()=>{const c=e.options.findIndex(a=>a[e.fields.value]===e.value),t=-Q(e.options,c)*e.optionHeight;m.value=t}),ce("touchmove",Y,{target:u}),()=>d("div",{ref:u,class:q(),onTouchstartPassive:U,onTouchend:H,onTouchcancel:H},[d("ul",{ref:g,style:{transform:`translate3d(0, ${m.value+w()}px, 0)`,transitionDuration:`${v.value}ms`,transitionProperty:v.value?"all":"none"},class:q("wrapper"),onTransitionend:N},[M()])])}});const[_e]=V("picker-toolbar"),R={title:String,cancelButtonText:String,confirmButtonText:String},me=["cancel","confirm","title","toolbar"],Ve=Object.keys(R);var fe=$({name:_e,props:R,emits:["confirm","cancel"],setup(e,{emit:o,slots:n}){const i=()=>{if(n.title)return n.title();if(e.title)return d("div",{class:[O("title"),"van-ellipsis"]},[e.title])},l=()=>o("cancel"),h=()=>o("confirm"),f=()=>{const u=e.cancelButtonText||ee("cancel");return d("button",{type:"button",class:[O("cancel"),X],onClick:l},[n.cancel?n.cancel():u])},b=()=>{const u=e.confirmButtonText||ee("confirm");return d("button",{type:"button",class:[O("confirm"),X],onClick:h},[n.confirm?n.confirm():u])};return()=>d("div",{class:O("toolbar")},[n.toolbar?n.toolbar():[f(),i(),b()]])}});const[ve,z]=V("picker-group"),he=Symbol(ve),$e=E({tabs:_(),nextStepText:String},R);$({name:ve,props:$e,emits:["confirm","cancel"],setup(e,{emit:o,slots:n}){const i=y(0),{children:l,linkChildren:h}=se(he);h();const f=()=>i.value<e.tabs.length-1&&e.nextStepText,b=()=>{f()?i.value++:o("confirm",l.map(g=>g.confirm()))},u=()=>o("cancel");return()=>{var g;const m=(g=n.default)==null?void 0:g.call(n),v=f()?e.nextStepText:e.confirmButtonText;return d("div",{class:z()},[d(fe,{title:e.title,cancelButtonText:e.cancelButtonText,confirmButtonText:v,onConfirm:b,onCancel:u},J(n,me)),d(Se,{active:i.value,"onUpdate:active":T=>i.value=T,class:z("tabs"),shrink:!0,animated:!0,lazyRender:!1},{default:()=>[e.tabs.map((T,p)=>d(we,{title:T,titleClass:z("tab-title")},{default:()=>[m==null?void 0:m[p]]}))]})])}}});const Re=E({loading:Boolean,readonly:Boolean,allowHtml:Boolean,optionHeight:K(44),showToolbar:Oe,swipeDuration:K(1e3),visibleOptionNum:K(6)},R),Ae=E({},Re,{columns:_(),modelValue:_(),toolbarPosition:pe("top"),columnsFieldNames:Object});var Fe=$({name:Pe,props:Ae,emits:["confirm","cancel","change","clickOption","update:modelValue"],setup(e,{emit:o,slots:n}){const i=y(),l=y(e.modelValue.slice(0)),{parent:h}=oe(he),{children:f,linkChildren:b}=se(de);b();const u=k(()=>Me(e.columnsFieldNames)),g=k(()=>Ce(e.optionHeight)),m=k(()=>Be(e.columns,u.value)),v=k(()=>{const{columns:t}=e;switch(m.value){case"multiple":return t;case"cascade":return Ne(t,u.value,l);default:return[t]}}),T=k(()=>v.value.some(t=>t.length)),p=k(()=>v.value.map((t,a)=>W(t,l.value[a],u.value))),w=k(()=>v.value.map((t,a)=>t.findIndex(s=>s[u.value.value]===l.value[a]))),C=(t,a)=>{if(l.value[t]!==a){const s=l.value.slice(0);s[t]=a,l.value=s}},x=()=>({selectedValues:l.value.slice(0),selectedOptions:p.value,selectedIndexes:w.value}),A=(t,a)=>{C(a,t),m.value==="cascade"&&l.value.forEach((s,D)=>{const S=v.value[D];te(S,s,u.value)||C(D,S.length?S[0][u.value.value]:void 0)}),Z(()=>{o("change",E({columnIndex:a},x()))})},P=(t,a)=>o("clickOption",E({columnIndex:a,currentOption:t},x())),B=()=>{f.forEach(a=>a.stopMomentum());const t=x();return Z(()=>{o("confirm",t)}),t},N=()=>o("cancel",x()),U=()=>v.value.map((t,a)=>d(Ie,{value:l.value[a],fields:u.value,options:t,readonly:e.readonly,allowHtml:e.allowHtml,optionHeight:g.value,swipeDuration:e.swipeDuration,visibleOptionNum:e.visibleOptionNum,onChange:s=>A(s,a),onClickOption:s=>P(s,a)},{option:n.option})),Y=t=>{if(T.value){const a={height:`${g.value}px`},s={backgroundSize:`100% ${(t-g.value)/2}px`};return[d("div",{class:O("mask"),style:s},null),d("div",{class:[Ee,O("frame")],style:a},null)]}},H=()=>{const t=g.value*+e.visibleOptionNum,a={height:`${t}px`};return d("div",{ref:i,class:O("columns"),style:a},[U(),Y(t)])},M=()=>{if(e.showToolbar&&!h)return d(fe,ye(J(e,Ve),{onConfirm:B,onCancel:N}),J(n,me))};j(v,t=>{t.forEach((a,s)=>{a.length&&!te(a,l.value[s],u.value)&&C(s,ue(a)[u.value.value])})},{immediate:!0});let c;return j(()=>e.modelValue,t=>{!L(t,l.value)&&!L(t,c)&&(l.value=t.slice(0))},{deep:!0}),j(l,t=>{L(t,e.modelValue)||(c=t.slice(0),o("update:modelValue",c))},{immediate:!0}),ce("touchmove",ie,{target:i}),le({confirm:B,getSelectedOptions:()=>p.value}),()=>{var t,a;return d("div",{class:O()},[e.toolbarPosition==="top"?M():null,e.loading?d(ke,{class:O("loading")},null):null,(t=n["columns-top"])==null?void 0:t.call(n),H(),(a=n["columns-bottom"])==null?void 0:a.call(n),e.toolbarPosition==="bottom"?M():null])}}});export{Re as p,Fe as s};
